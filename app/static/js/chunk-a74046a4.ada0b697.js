(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-a74046a4"],{1472:function(t,e,r){"use strict";r.d(e,"f",(function(){return i})),r.d(e,"n",(function(){return a})),r.d(e,"p",(function(){return n})),r.d(e,"k",(function(){return u})),r.d(e,"o",(function(){return d})),r.d(e,"v",(function(){return s})),r.d(e,"e",(function(){return c})),r.d(e,"a",(function(){return l})),r.d(e,"g",(function(){return p})),r.d(e,"q",(function(){return f})),r.d(e,"b",(function(){return m})),r.d(e,"h",(function(){return h})),r.d(e,"s",(function(){return g})),r.d(e,"t",(function(){return b})),r.d(e,"l",(function(){return _})),r.d(e,"r",(function(){return v})),r.d(e,"d",(function(){return j})),r.d(e,"j",(function(){return y})),r.d(e,"u",(function(){return A})),r.d(e,"c",(function(){return F})),r.d(e,"i",(function(){return O})),r.d(e,"m",(function(){return S}));r("7f7f");var o=r("337a");function i(t){var e=t.group_name,r=t.project_id;return Object(o["a"])({url:"/AuthorityApi/group",method:"post",data:{group_name:e,project_id:r}})}function a(){return Object(o["a"])({url:"/AuthorityApi/group",method:"get"})}function n(){return Object(o["a"])({url:"/AuthorityApi/project",method:"get"})}function u(t){var e=t.group_id,r=t.group_name,i=t.project_id;return Object(o["a"])({url:"/AuthorityApi/group",method:"PUT",data:{group_id:e,group_name:r,project_id:i}})}function d(t){return Object(o["a"])({url:"/AuthorityApi/groupuser",method:"get",params:{group_id:t}})}function s(t){var e=t.username,r=void 0===e?"":e;return Object(o["a"])({url:"/AuthorityApi/groupuseradd",method:"post",data:{username:r}})}function c(t){var e=t.group_id,r=t.uid,i=t.type,a=void 0===i?1:i;return Object(o["a"])({url:"/AuthorityApi/checkgroupuser",method:"post",data:{group_id:e,uid:r,type:a}})}function l(t){var e=t.group_id,r=t.uid;return Object(o["a"])({url:"/AuthorityApi/groupuser",method:"POST",data:{group_id:e,uid:r}})}function p(t){var e=t.group_id,r=t.uid;return Object(o["a"])({url:"/AuthorityApi/groupuser",method:"DELETE",data:{group_id:e,uid:r}})}function f(){return Object(o["a"])({url:"/AuthorityApi/user",method:"get"})}function m(t){var e=t.name,r=t.username,i=t.role,a=t.ip_type;return Object(o["a"])({url:"/AuthorityApi/user",method:"POST",data:{name:e,username:r,role:i,ip_type:a}})}function h(t){return Object(o["a"])({url:"/AuthorityApi/user",method:"DELETE",data:{uid:t}})}function g(t){return Object(o["a"])({url:"/AuthorityApi/userinfo",method:"get",params:{uid:t}})}function b(t){return Object(o["a"])({url:"/AuthorityApi/usergroup",method:"get",params:{uid:t}})}function _(t){var e=t.uid,r=t.name,i=t.role,a=t.type;return Object(o["a"])({url:"/AuthorityApi/user",method:"put",data:{uid:e,name:r,role:i,type:a}})}function v(t){return Object(o["a"])({url:"/AuthorityApi/usergroupadd",method:"POST",data:{uid:t}})}function j(t){var e=t.uid,r=t.group_id;return Object(o["a"])({url:"/AuthorityApi/usergroup",method:"POST",data:{uid:e,group_id:r}})}function y(t){var e=t.uid,r=t.group_id;return Object(o["a"])({url:"/AuthorityApi/usergroup",method:"DELETE",data:{uid:e,group_id:r}})}function A(t){var e=t.uid;return Object(o["a"])({url:"/AuthorityApi/checkuserenv",method:"post",data:{uid:e}})}function F(t){var e=t.uid,r=t.ip_type;return Object(o["a"])({url:"/AuthorityApi/userenv",method:"post",data:{uid:e,ip_type:r}})}function O(t){var e=t.uid,r=t.ip_type;return Object(o["a"])({url:"/AuthorityApi/userenv",method:"DELETE",data:{uid:e,ip_type:r}})}function S(t){return Object(o["a"])({url:"/AuthorityApi/envipinfo",method:"POST",data:{ip_type:t}})}},"855d":function(t,e,r){"use strict";r.r(e);var o=function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("el-card",[r("el-row",[r("el-col",{attrs:{span:6}},[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[t._v("分组列表")])]),t._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(e){t.visible=!0}}},[t._v("新建分组")]),t._v(" "),t._l(t.groupList,(function(e){return r("div",{key:e.id,staticClass:"text item",class:t.curGroup.id===e.id?"isActive":"",staticStyle:{padding:"4px"}},[r("span",{staticStyle:{cursor:"pointer"},on:{click:function(r){return t.handleShowGroup(e)}}},[t._v(t._s(e.group_name))]),t._v(" "),r("span",{staticStyle:{cursor:"pointer",float:"right"},on:{click:function(){return t.handleEditGroup(e)}}},[r("i",{staticClass:"el-icon-edit"})])])}))],2)],1),t._v(" "),t.showGroup?r("el-col",{attrs:{span:18}},[r("el-button",{staticStyle:{margin:"30px 0"},attrs:{type:"primary"},on:{click:t.handleAddStaff}},[t._v("添加员工")]),t._v(" "),r("el-table",{attrs:{data:t.tableData,border:""}},[r("el-table-column",{attrs:{prop:"uid",fixed:"left",label:"uid",width:"100"}}),t._v(" "),r("el-table-column",{attrs:{prop:"name",label:"姓名",width:"180"}}),t._v(" "),r("el-table-column",{attrs:{prop:"username",label:"邮箱"}}),t._v(" "),r("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:t._u([{key:"default",fn:function(e){return[r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(r){return t.handleDelete(e.row)}}},[t._v("删除")])]}}],null,!1,184298474)})],1)],1):t._e()],1),t._v(" "),r("el-dialog",{attrs:{title:"新建分组",visible:t.visible},on:{"update:visible":function(e){t.visible=e}}},[r("el-form",{ref:"addFormEl",attrs:{model:t.addForm,rules:t.editFormRules}},[r("el-form-item",{attrs:{label:"组名称","label-width":t.formLabelWidth,prop:"group_name"}},[r("el-input",{model:{value:t.addForm.group_name,callback:function(e){t.$set(t.addForm,"group_name",e)},expression:"addForm.group_name"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"项目工程","label-width":t.formLabelWidth,prop:"project_id"}},[r("el-checkbox-group",{model:{value:t.addForm.project_id,callback:function(e){t.$set(t.addForm,"project_id",e)},expression:"addForm.project_id"}},t._l(t.projectList,(function(e){return r("el-checkbox",{key:e.id,attrs:{label:e.id,name:"editProject"}},[t._v(t._s(e.project_name))])})),1)],1)],1),t._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:t.cancleAddGroup}},[t._v("取 消")]),t._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:t.handleCreatGroup}},[t._v("确 定")])],1)],1),t._v(" "),r("el-dialog",{attrs:{title:"编辑分组",visible:t.editVisible},on:{"update:visible":function(e){t.editVisible=e}}},[r("el-form",{ref:"editFormEl",attrs:{model:t.editForm,rules:t.editFormRules}},[r("el-form-item",{attrs:{label:"组名称","label-width":t.formLabelWidth,prop:"group_name"}},[r("el-input",{model:{value:t.editForm.group_name,callback:function(e){t.$set(t.editForm,"group_name",e)},expression:"editForm.group_name"}})],1),t._v(" "),r("el-form-item",{attrs:{label:"项目工程","label-width":t.formLabelWidth,prop:"project_id"}},[r("el-checkbox-group",{model:{value:t.editForm.project_id,callback:function(e){t.$set(t.editForm,"project_id",e)},expression:"editForm.project_id"}},t._l(t.projectList,(function(e){return r("el-checkbox",{key:e.id,attrs:{label:e.id,name:"editProject"}},[t._v(t._s(e.project_name))])})),1)],1)],1),t._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(e){t.editVisible=!1}}},[t._v("取 消")]),t._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:t.confirmEditGorup}},[t._v("确 定")])],1)],1),t._v(" "),r("el-dialog",{ref:"addStafffEl",attrs:{title:"添加员工",visible:t.addVisible},on:{"update:visible":function(e){t.addVisible=e}}},[r("el-form",{attrs:{model:t.addStaffForm}},[r("el-form-item",{attrs:{label:"员工邮箱","label-width":t.formLabelWidth}},[r("el-autocomplete",{attrs:{"fetch-suggestions":t.queryGroupUser,placeholder:"请输入邮箱"},on:{select:t.selStaff},model:{value:t.addStaffForm.add,callback:function(e){t.$set(t.addStaffForm,"add",e)},expression:"addStaffForm.add"}})],1)],1),t._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:t.cancelAddStaff}},[t._v("取 消")]),t._v(" "),r("el-button",{attrs:{type:"primary",disabled:t.addStaffConfim},on:{click:t.addGroupUser}},[t._v("确 定")])],1)],1)],1)},i=[],a=(r("7f7f"),r("c5f6"),r("28a5"),r("ac6a"),r("1472")),n={name:"GroupManagement",data:function(){return{addVisible:!1,visible:!1,editVisible:!1,groupList:[],projectList:[],form:{groupName:"",project:[],editGroupName:"",editProject:["2"],staffAccount:""},addForm:{group_name:"",project_id:[]},editForm:{group_name:"",id:null,project_id:[]},editFormRules:{group_name:[{required:!0,message:"请输入分组名称",trigger:["blur","change"]}],project_id:[{type:"array",required:!0,message:"请选择项目工程",trigger:["change"]}]},addStaffForm:{},formLabelWidth:"120px",showGroup:!1,curGroup:{id:""},tableData:[{uid:"1",name:"jiaqi.fan",username:"jiaqi.fan@wenba100.com"},{uid:"2",name:"jiaqi.fan",username:"jiaqi.fan@wenba100.com"},{uid:"3",name:"jiaqi.fan",username:"jiaqi.fan@wenba100.com"},{uid:"4",name:"jiaqi.fan",username:"jiaqi.fan@wenba100.com"}],addStaffConfim:!0}},created:function(){this.getGroup(),this.getProjectList()},mounted:function(){},methods:{getGroup:function(){var t=this;Object(a["n"])().then((function(e){console.log(e),200===e.statusCode&&(t.groupList=e.data)}))},getProjectList:function(){var t=this;Object(a["p"])().then((function(e){console.log(e),200===e.statusCode&&(t.projectList=e.data)}))},handleShowGroup:function(t){var e=this;this.showGroup=!0,this.curGroup=t,Object(a["o"])(t.id).then((function(t){console.log(t),200===t.statusCode&&(e.tableData=t.data)}))},handleAddStaff:function(){this.addVisible=!0},cancelAddStaff:function(){this.addVisible=!1,this.addStaffForm={}},cancleAddGroup:function(){this.visible=!1,this.$refs.addFormEl.resetFields()},handleCreatGroup:function(){var t=this;this.$refs.addFormEl.validate((function(e){e&&Object(a["f"])({group_name:t.addForm.group_name,project_id:t.addForm.project_id.join(",")}).then((function(e){200===e.statusCode?(t.visible=!1,t.getGroup(),t.$refs.addFormEl.resetFields(),t.$message({type:"success",message:e.msg})):t.$message.error(e.msg)}))}))},handleEditGroup:function(t){var e=[];t.project_id.split(",").forEach((function(t){e.push(Number(t))})),this.editForm.group_name=t.group_name,this.editForm.project_id=e,this.editForm.id=t.id,this.editVisible=!0},confirmEditGorup:function(){var t=this;this.$refs.editFormEl.validate((function(e){e&&Object(a["k"])({group_id:t.editForm.id,group_name:t.editForm.group_name,project_id:t.editForm.project_id.join(",")}).then((function(e){200===e.statusCode?(t.editVisible=!1,t.$refs.editFormEl.resetFields(),t.getGroup(),t.$message({message:e.msg,type:"success"})):t.$message.error(e.msg)}))}))},handleDelete:function(t){var e=this;console.log(t),this.$confirm("此操作将删除该员工, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){Object(a["g"])({group_id:e.curGroup.id,uid:t.uid}).then((function(t){200===t.statusCode?(e.$message({type:"success",message:t.msg}),e.handleShowGroup(e.curGroup)):e.$message.error(t.msg)}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},queryGroupUser:function(t,e){console.log(t),Object(a["v"])({username:t}).then((function(t){if(200===t.statusCode){e(t.data);var r=[];t.data.forEach((function(t){r.push({value:"".concat(null===t.name?"":t.name,"(").concat(t.username,")"),username:t.username,id:t.id,name:t.name})})),e(r)}}))},selStaff:function(t){var e=this;console.log(t),this.addStaffForm=t,this.addStaffForm.add="".concat(t.name," (").concat(t.username,")"),Object(a["e"])({group_id:this.curGroup.id,uid:t.id,type:1}).then((function(t){console.log(t),200===t.statusCode?e.addStaffConfim=!1:(e.addStaffConfim=!0,e.$message.error(t.msg))}))},addGroupUser:function(){var t=this;Object(a["a"])({group_id:this.curGroup.id,uid:this.addStaffForm.id}).then((function(e){200===e.statusCode?(t.addVisible=!1,t.$message({message:e.msg,type:"success"}),t.addStaffForm={},t.handleShowGroup(t.curGroup),t.$refs.addStafffEl.resetFields()):t.$message.error(e.msg)}))}}},u=n,d=(r("c8ad"),r("2877")),s=Object(d["a"])(u,o,i,!1,null,"93dce320",null);e["default"]=s.exports},c8ad:function(t,e,r){"use strict";var o=r("de67"),i=r.n(o);i.a},de67:function(t,e,r){}}]);