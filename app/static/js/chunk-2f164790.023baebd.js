(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2f164790"],{"015e":function(e,t,r){"use strict";r.d(t,"j",(function(){return a})),r.d(t,"m",(function(){return o})),r.d(t,"d",(function(){return n})),r.d(t,"r",(function(){return s})),r.d(t,"f",(function(){return l})),r.d(t,"q",(function(){return c})),r.d(t,"p",(function(){return u})),r.d(t,"n",(function(){return d})),r.d(t,"h",(function(){return m})),r.d(t,"i",(function(){return p})),r.d(t,"a",(function(){return f})),r.d(t,"c",(function(){return h})),r.d(t,"k",(function(){return g})),r.d(t,"l",(function(){return v})),r.d(t,"g",(function(){return _})),r.d(t,"o",(function(){return b})),r.d(t,"b",(function(){return y})),r.d(t,"e",(function(){return j}));var i=r("337a");function a(){return Object(i["a"])({url:"/RestfulApi/Monitor",method:"get"})}function o(e){return Object(i["a"])({url:"/OperationTree/PerformanceTreeCheck",method:"post",data:{uid:e}})}function n(e,t,r,a,o){return Object(i["a"])({url:"/OperationTree/PerformanceTree",method:"post",data:{filename:e,pid:t,file_type:r,uid:a,project_type:2,Permission_parameters:o}})}function s(e){return Object(i["a"])({url:"/OperationTree/PerformanceTree",method:"put",data:e})}function l(e,t){return Object(i["a"])({url:"/OperationTree/PerformanceTree",method:"DELETE",data:{id:e,Permission_parameters:t}})}function c(e){return Object(i["a"])({url:"/RestfulApi/ScriptGeneration",method:"post",data:e})}function u(e,t){return Object(i["a"])({url:"/RestfulApi/Register",method:"post",data:{username:e,password:t}})}function d(e){return Object(i["a"])({url:"/RestfulApi/Implement",method:"post",data:e})}function m(e){return Object(i["a"])({url:"/RestfulApi/RealtimeLog",method:"post",data:{data:e}})}function p(e){return Object(i["a"])({url:"/RestfulApi/BatchLog",method:"post",data:{data:e}})}function f(e){return Object(i["a"])({url:"/RestfulApi/BatchExecution",method:"post",data:e})}function h(){return Object(i["a"])({url:"/RestfulApi/KillAllProcess",method:"get"})}function g(e){return Object(i["a"])({url:"/RestfulFile/ScriptGeneration",method:"post",data:e})}function v(e){return Object(i["a"])({url:"/RestfulFile/UploadScript",method:"post",data:e})}function _(e){var t=e.file_name;return Object(i["a"])({url:"/AuxiliaryFunction/PressureMeasurement",method:"POST",data:{file_name:t}})}function b(e){var t=e.useremail,r=e.datamsg;return Object(i["a"])({url:"/AuxiliaryFunction/ResultEmail",method:"post",data:{useremail:t,datamsg:r}})}function y(e){return Object(i["a"])({url:"/RestfulFile/Checkcomplete",method:"post",data:e})}function j(e){return Object(i["a"])({url:"/RestfulFile/Checklogexsits",method:"post",data:e})}},1472:function(e,t,r){"use strict";r.d(t,"f",(function(){return a})),r.d(t,"n",(function(){return o})),r.d(t,"p",(function(){return n})),r.d(t,"k",(function(){return s})),r.d(t,"o",(function(){return l})),r.d(t,"v",(function(){return c})),r.d(t,"e",(function(){return u})),r.d(t,"a",(function(){return d})),r.d(t,"g",(function(){return m})),r.d(t,"q",(function(){return p})),r.d(t,"b",(function(){return f})),r.d(t,"h",(function(){return h})),r.d(t,"s",(function(){return g})),r.d(t,"t",(function(){return v})),r.d(t,"l",(function(){return _})),r.d(t,"r",(function(){return b})),r.d(t,"d",(function(){return y})),r.d(t,"j",(function(){return j})),r.d(t,"u",(function(){return F})),r.d(t,"c",(function(){return S})),r.d(t,"i",(function(){return x})),r.d(t,"m",(function(){return k}));r("7f7f");var i=r("337a");function a(e){var t=e.group_name,r=e.project_id;return Object(i["a"])({url:"/AuthorityApi/group",method:"post",data:{group_name:t,project_id:r}})}function o(){return Object(i["a"])({url:"/AuthorityApi/group",method:"get"})}function n(){return Object(i["a"])({url:"/AuthorityApi/project",method:"get"})}function s(e){var t=e.group_id,r=e.group_name,a=e.project_id;return Object(i["a"])({url:"/AuthorityApi/group",method:"PUT",data:{group_id:t,group_name:r,project_id:a}})}function l(e){return Object(i["a"])({url:"/AuthorityApi/groupuser",method:"get",params:{group_id:e}})}function c(e){var t=e.username,r=void 0===t?"":t;return Object(i["a"])({url:"/AuthorityApi/groupuseradd",method:"post",data:{username:r}})}function u(e){var t=e.group_id,r=e.uid,a=e.type,o=void 0===a?1:a;return Object(i["a"])({url:"/AuthorityApi/checkgroupuser",method:"post",data:{group_id:t,uid:r,type:o}})}function d(e){var t=e.group_id,r=e.uid;return Object(i["a"])({url:"/AuthorityApi/groupuser",method:"POST",data:{group_id:t,uid:r}})}function m(e){var t=e.group_id,r=e.uid;return Object(i["a"])({url:"/AuthorityApi/groupuser",method:"DELETE",data:{group_id:t,uid:r}})}function p(){return Object(i["a"])({url:"/AuthorityApi/user",method:"get"})}function f(e){var t=e.name,r=e.username,a=e.role,o=e.ip_type;return Object(i["a"])({url:"/AuthorityApi/user",method:"POST",data:{name:t,username:r,role:a,ip_type:o}})}function h(e){return Object(i["a"])({url:"/AuthorityApi/user",method:"DELETE",data:{uid:e}})}function g(e){return Object(i["a"])({url:"/AuthorityApi/userinfo",method:"get",params:{uid:e}})}function v(e){return Object(i["a"])({url:"/AuthorityApi/usergroup",method:"get",params:{uid:e}})}function _(e){var t=e.uid,r=e.name,a=e.role,o=e.type;return Object(i["a"])({url:"/AuthorityApi/user",method:"put",data:{uid:t,name:r,role:a,type:o}})}function b(e){return Object(i["a"])({url:"/AuthorityApi/usergroupadd",method:"POST",data:{uid:e}})}function y(e){var t=e.uid,r=e.group_id;return Object(i["a"])({url:"/AuthorityApi/usergroup",method:"POST",data:{uid:t,group_id:r}})}function j(e){var t=e.uid,r=e.group_id;return Object(i["a"])({url:"/AuthorityApi/usergroup",method:"DELETE",data:{uid:t,group_id:r}})}function F(e){var t=e.uid;return Object(i["a"])({url:"/AuthorityApi/checkuserenv",method:"post",data:{uid:t}})}function S(e){var t=e.uid,r=e.ip_type;return Object(i["a"])({url:"/AuthorityApi/userenv",method:"post",data:{uid:t,ip_type:r}})}function x(e){var t=e.uid,r=e.ip_type;return Object(i["a"])({url:"/AuthorityApi/userenv",method:"DELETE",data:{uid:t,ip_type:r}})}function k(e){return Object(i["a"])({url:"/AuthorityApi/envipinfo",method:"POST",data:{ip_type:e}})}},"1a5d":function(e,t,r){"use strict";var i=r("6d95"),a=r.n(i);a.a},"3d81":function(e,t,r){"use strict";var i=r("a351"),a=r.n(i);a.a},"3e19":function(e,t,r){"use strict";r.r(t);var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-card",{attrs:{id:"creatProject"}},[r("el-row",[r("el-col",{attrs:{span:5}},["admin"===e.$store.state.user.roles?r("el-button",{attrs:{type:"primary"},on:{click:e.handleNewProject}},[e._v("新建项目")]):e._e(),e._v(" "),r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("我的项目")])]),e._v(" "),r("div",{staticClass:"treecontain"},[r("el-scrollbar",{staticStyle:{height:"100%"}},[r("el-tree",{attrs:{data:e.treeDataList,"node-key":"id","default-expanded-keys":e.expandArr,props:e.defaultProps,"expand-on-click-node":!0},on:{"node-click":e.handleEditScript},scopedSlots:e._u([{key:"default",fn:function(t){var i=t.node,a=t.data;return r("span",{staticClass:"custom-tree-node"},[i.label.length<=10?r("span",[r("span",[2===a.file_type?r("i",{staticClass:"el-icon-time"}):e._e(),e._v(" "),3===a.file_type?r("i",{staticClass:"el-icon-odometer"}):e._e()]),e._v("\n                  "+e._s(i.label)+"\n                ")]):i.label.length>10?r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:i.label,placement:"top"}},[r("span",[e._v(e._s(i.label.length>10?i.label.slice(0,10)+"...":i.label))])]):e._e(),e._v(" "),r("span",[r("el-popover",{staticStyle:{"min-width":"106px"},attrs:{placement:"top",width:"100"}},[!0===e.popProject?r("el-button",{attrs:{size:"mini",type:"primary"},on:{"!click":function(t){return function(){return e.handleCreatNode(i,a)}()}}},[e._v("新建项目")]):e._e(),e._v(" "),!0===e.popScript?r("div",[r("div",[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(){return e.handleCreatScript(i,a)}}},[e._v("新建脚本")])],1),e._v(" "),r("div",{staticStyle:{"margin-top":"4px"}},[r("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(){return e.handleCreatFullLinkScript(i,a)}}},[e._v("新建全链路脚本")])],1)]):e._e(),e._v(" "),2==i.data.file_type||"admin"!==i.data.tree_authority&&-1===i.data.tree_authority.indexOf(13)?e._e():r("el-button",{attrs:{slot:"reference",type:"text"},on:{click:function(t){return t.stopPropagation(),function(){return e.append(i,a)}()}},slot:"reference"},[r("i",{staticClass:"el-icon-circle-plus-outline"})])],1),e._v(" "),0===i.data.pid||"admin"!==i.data.tree_authority&&-1===i.data.tree_authority.indexOf(12)?e._e():r("el-button",{attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),function(){return e.remove(i,a)}()}}},[r("i",{staticClass:"el-icon-remove-outline"})]),e._v(" "),2!==i.data.file_type||"admin"!==i.data.tree_authority&&-1===i.data.tree_authority.indexOf(11)?1!==i.data.file_type||0===i.data.pid||"admin"!==i.data.tree_authority&&-1===i.data.tree_authority.indexOf(11)?1!==i.data.file_type||0!==i.data.pid||"admin"!==i.data.tree_authority&&-1===i.data.tree_authority.indexOf(2)?e._e():r("el-popover",{attrs:{placement:"top",width:"auto"}},[r("div",[!0===e.editName?r("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(t){return t.stopPropagation(),e.handleProjectManage(i,a)}}},[e._v("项目管理")]):e._e()],1),e._v(" "),r("el-button",{attrs:{slot:"reference",type:"text"},on:{click:function(t){return t.stopPropagation(),function(){return e.edit(i,a)}()}},slot:"reference"},[r("i",{staticClass:"el-icon-edit"})])],1):r("el-button",{attrs:{type:"text"},on:{click:function(t){return t.stopPropagation(),function(){return e.edit(i,a)}()}}},[r("i",{staticClass:"el-icon-edit"})]):r("el-popover",{attrs:{placement:"top",width:"auto"}},[r("div",[!0===e.editName?r("el-button",{attrs:{size:"mini",type:"primary"},on:{"!click":function(t){return e.handleEditName(i)}}},[e._v("编辑名称")]):e._e()],1),e._v(" "),r("el-button",{attrs:{slot:"reference",type:"text"},on:{click:function(t){return t.stopPropagation(),function(){return e.edit(i,a)}()}},slot:"reference"},[r("i",{staticClass:"el-icon-edit"})])],1)],1)],1)}}])})],1)],1)])],1),e._v(" "),"projectManage"===e.currentType?r("el-col",{attrs:{span:18,offset:1}},[r("el-row",{staticStyle:{"margin-bottom":"10px"}},[r("el-col",{attrs:{span:2}},[e._v("分组")]),e._v(" "),"admin"===e.curProject.tree_authority||-1!==e.curProject.tree_authority.indexOf(3)?r("el-col",{attrs:{span:2,offset:20}},[r("el-button",{attrs:{type:"primary"},on:{click:e.handleAddGroup}},[e._v("添加分组")])],1):e._e()],1),e._v(" "),"admin"===e.curProject.tree_authority||-1!==e.curProject.tree_authority.indexOf(5)?r("el-table",{attrs:{data:e.groupsData,border:""}},[r("template",{slot:"empty"},[e._v("\n          "+e._s(e.emptyText)+"\n        ")]),e._v(" "),r("el-table-column",{attrs:{prop:"group_name",fixed:"left",label:"分组",width:"120"}}),e._v(" "),e._l(e.labelList,(function(t){return r("el-table-column",{key:t.func_id,attrs:{label:t.label,width:"80"},scopedSlots:e._u([{key:"default",fn:function(i){return[-1!==i.row.func_id.indexOf(t.func_id+"")?r("i",{staticClass:"el-icon-check"}):e._e()]}}],null,!0)})})),e._v(" "),r("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return["admin"===e.curProject.tree_authority||-1!==e.curProject.tree_authority.indexOf(6)?r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(){return e.handleDeleteGroup(t.row)}}},[e._v("\n              删除\n            ")]):e._e(),e._v(" "),"admin"===e.curProject.tree_authority||-1!==e.curProject.tree_authority.indexOf(4)?r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(){return e.handleEditGroup(t.row)}}},[e._v("\n              编辑\n            ")]):e._e()]}}],null,!1,768234164)})],2):e._e(),e._v(" "),r("el-row",{staticStyle:{margin:"20px 0 10px 0"}},[r("el-col",{attrs:{span:2}},[e._v("员工")]),e._v(" "),"admin"===e.curProject.tree_authority||-1!==e.curProject.tree_authority.indexOf(7)?r("el-col",{attrs:{span:2,offset:20}},[r("el-button",{attrs:{type:"primary"},on:{click:e.handleAddStaff}},[e._v("添加员工")])],1):e._e()],1),e._v(" "),r("el-table",{attrs:{data:e.staffData,border:""}},[r("template",{slot:"empty"},[e._v("\n          "+e._s(e.emptyText)+"\n        ")]),e._v(" "),r("el-table-column",{attrs:{prop:"username",label:"员工名",fixed:"left",width:"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("div",[e._v("\n              "+e._s(t.row.name)+" ("+e._s(t.row.username)+")\n\n            ")]),e._v(" "),r("div")]}}],null,!1,364521072)}),e._v(" "),e._l(e.labelList,(function(t){return r("el-table-column",{key:t.func_id,attrs:{label:t.label,width:"80"},scopedSlots:e._u([{key:"default",fn:function(i){return[-1!==i.row.func_id.indexOf(t.func_id+"")?r("i",{staticClass:"el-icon-check"}):e._e()]}}],null,!0)})})),e._v(" "),r("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return["admin"===e.curProject.tree_authority||-1!==e.curProject.tree_authority.indexOf(10)?r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(){return e.handleDeleteStaff(t.row)}}},[e._v("\n              删除\n            ")]):e._e(),e._v(" "),"admin"===e.curProject.tree_authority||-1!==e.curProject.tree_authority.indexOf(8)?r("el-button",{attrs:{type:"text",size:"small"},on:{click:function(){return e.handleEditStaff(t.row)}}},[e._v("\n              编辑\n            ")]):e._e()]}}],null,!1,1340771567)})],2)],1):"editScript"===e.currentType?r("el-col",{attrs:{span:18,offset:1}},[r("EditScript",{attrs:{"current-node-name":e.currentNodeName,"cur-script":e.curScript,"cur-node":e.curNode,"edit-node":e.editNode,"script-visible":e.editScriptVisible,"user-env":e.userEnv},on:{updataTreeData:e.getTree}})],1):e._e()],1),e._v(" "),r("el-form",{ref:"form",attrs:{model:e.form,rules:e.rules,"label-width":"80px"}},[r("el-dialog",{attrs:{title:"创建项目",visible:e.creatVisible},on:{"update:visible":function(t){e.creatVisible=t}}},[r("el-form-item",{attrs:{label:"当前项目"}},[e._v("\n        "+e._s(e.currentNodeName)+"\n      ")]),e._v(" "),r("el-form-item",{attrs:{label:"项目名称"}},[r("el-input",{model:{value:e.form.filename,callback:function(t){e.$set(e.form,"filename",t)},expression:"form.filename"}})],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.creatVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.handleCreatProject}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"编辑项目",visible:e.editVisible},on:{"update:visible":function(t){e.editVisible=t}}},[r("el-form-item",{attrs:{label:"当前项目"}},[e._v("\n        "+e._s(e.currentNodeName)+"\n      ")]),e._v(" "),r("el-form-item",{attrs:{label:"项目名称"}},[r("el-input",{model:{value:e.form.eidtfilename,callback:function(t){e.$set(e.form,"eidtfilename",t)},expression:"form.eidtfilename"}})],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.handleEditProject}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"创建脚本",visible:e.creatScriptVisible},on:{"update:visible":function(t){e.creatScriptVisible=t}}},[r("el-form-item",{attrs:{label:"当前项目"}},[e._v("\n        "+e._s(e.currentNodeName)+"\n      ")]),e._v(" "),r("el-form-item",{attrs:{label:"脚本名称"}},[r("el-input",{model:{value:e.form.scriptName,callback:function(t){e.$set(e.form,"scriptName",t)},expression:"form.scriptName"}})],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.creatScriptVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.handleCreatProject}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"编辑脚本",visible:e.editScriptNameVisible},on:{"update:visible":function(t){e.editScriptNameVisible=t}}},[r("el-form-item",{attrs:{label:"当前项目"}},[e._v("\n        "+e._s(e.currentNodeName)+"\n      ")]),e._v(" "),r("el-form-item",{attrs:{label:"脚本名称"}},[r("el-input",{model:{value:e.form.editScriptName,callback:function(t){e.$set(e.form,"editScriptName",t)},expression:"form.editScriptName"}})],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editScriptNameVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.handleEditScriptName}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"新建项目",visible:e.newProjectVisible},on:{"update:visible":function(t){e.newProjectVisible=t}}},[r("el-form-item",{attrs:{label:"项目名称"}},[r("el-input",{model:{value:e.form.rootProjectName,callback:function(t){e.$set(e.form,"rootProjectName",t)},expression:"form.rootProjectName"}})],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.cancleAddProject}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.addProjectComfirm}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"添加分组",visible:e.addGroupsVisible},on:{"update:visible":function(t){e.addGroupsVisible=t}}},[r("el-form-item",{attrs:{label:"选择分组"}},[r("el-select",{model:{value:e.form.selectGroup,callback:function(t){e.$set(e.form,"selectGroup",t)},expression:"form.selectGroup"}},e._l(e.groupListInAdd,(function(e){return r("el-option",{key:e.id,attrs:{value:e.id,label:e.group_name}})})),1)],1),e._v(" "),r("el-form-item",{attrs:{label:"选择权限"}},[r("el-checkbox-group",{model:{value:e.form.selGroupRight,callback:function(t){e.$set(e.form,"selGroupRight",t)},expression:"form.selGroupRight"}},e._l(e.labelList,(function(t){return r("el-checkbox",{key:t.func_id,attrs:{name:"right",label:t.func_id}},[e._v(e._s(t.label)+"\n          ")])})),1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.cancleaddGroups}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.addGroupRight}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"添加员工",visible:e.addStaffVisible},on:{"update:visible":function(t){e.addStaffVisible=t}}},[r("el-form-item",{attrs:{label:"员工邮箱"}},[r("el-autocomplete",{attrs:{width:"60%","fetch-suggestions":e.queryStaff,placeholder:"请输入员工邮箱"},on:{select:e.selStaff},model:{value:e.form.staffAccount,callback:function(t){e.$set(e.form,"staffAccount",t)},expression:"form.staffAccount"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"选择权限"}},[r("el-checkbox-group",{model:{value:e.form.selStaffRight,callback:function(t){e.$set(e.form,"selStaffRight",t)},expression:"form.selStaffRight"}},e._l(e.labelList,(function(t){return r("el-checkbox",{key:t.func_id,attrs:{name:"right",label:t.func_id}},[e._v(e._s(t.label)+"\n          ")])})),1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:e.cancleAddStaff}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.addStaff}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"编辑分组权限",visible:e.editRightVisible},on:{"update:visible":function(t){e.editRightVisible=t}}},[r("el-form-item",{attrs:{label:"编辑权限"}},[r("el-checkbox-group",{model:{value:e.form.right,callback:function(t){e.$set(e.form,"right",t)},expression:"form.right"}},e._l(e.labelList,(function(t){return r("el-checkbox",{key:t.func_id,attrs:{name:"right",label:t.func_id}},[e._v(e._s(t.label)+"\n          ")])})),1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editRightVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.editGroupRight}},[e._v("确 定")])],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"编辑员工权限",visible:e.editStaffVisible},on:{"update:visible":function(t){e.editStaffVisible=t}}},[r("el-form-item",{attrs:{label:"编辑权限"}},[r("el-checkbox-group",{model:{value:e.form.staffRight,callback:function(t){e.$set(e.form,"staffRight",t)},expression:"form.staffRight"}},e._l(e.labelList,(function(t){return r("el-checkbox",{key:t.func_id,attrs:{name:"right",label:t.func_id}},[e._v(e._s(t.label)+"\n          ")])})),1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.editStaffVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.editStaffRight}},[e._v("确 定")])],1)],1)],1),e._v(" "),r("el-dialog",{attrs:{title:"创建全链路脚本",visible:e.FullLinkVisible},on:{"update:visible":function(t){e.FullLinkVisible=t}}},[r("el-form",{attrs:{model:e.linkForm,"label-width":"120px"}},[r("el-form-item",{attrs:{label:"当前项目"}},[e._v("\n        "+e._s(e.currentNodeName)+"\n      ")]),e._v(" "),r("el-form-item",{attrs:{label:"脚本名称"}},[r("el-input",{model:{value:e.linkForm.name,callback:function(t){e.$set(e.linkForm,"name",t)},expression:"linkForm.name"}})],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.FullLinkVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.handleEditFullLinkScipt}},[e._v("确 定")])],1)],1)],1)},a=[],o=r("75fc"),n=(r("96cf"),r("3b8d")),s=(r("28a5"),r("7f7f"),r("ac6a"),r("c5f6"),r("015e")),l=r("337a"),c=r("4360");function u(e){var t=e.filename,r=e.pid,i=e.file_type,a=e.uid,o=void 0===a?c["a"].state.user.uid:a,n=e.project_type,s=void 0===n?2:n,u=e.Permission_parameters;return Object(l["a"])({url:"/OperationTree/PerformanceTree",method:"post",data:{filename:t,pid:r,file_type:i,uid:o,project_type:s,Permission_parameters:u}})}function d(e){var t=e.tree_id,r=e.project_id,i=void 0===r?2:r,a=e.Permission_parameters;return Object(l["a"])({url:"/AuthorityApi/querygroupfunc",method:"post",data:{tree_id:t,project_id:i,Permission_parameters:a}})}function m(e){var t=e.tree_id,r=e.project_id,i=void 0===r?2:r,a=e.Permission_parameters;return Object(l["a"])({url:"/AuthorityApi/queryuserfunc",method:"post",data:{tree_id:t,project_id:i,Permission_parameters:a}})}function p(e){var t=e.project_id,r=void 0===t?2:t,i=e.Permission_parameters;return Object(l["a"])({url:"/AuthorityApi/queryfunc",method:"post",data:{project_id:r,Permission_parameters:i}})}function f(e){var t=e.group_id,r=e.tree_id,i=e.func_id,a=e.project_id,o=void 0===a?2:a,n=e.Permission_parameters;return Object(l["a"])({url:"/AuthorityApi/groupfunc",method:"put",data:{group_id:t,tree_id:r,func_id:i,project_id:o,Permission_parameters:n}})}function h(e){var t=e.uid,r=e.tree_id,i=e.func_id,a=e.project_id,o=void 0===a?2:a,n=e.Permission_parameters;return Object(l["a"])({url:"/AuthorityApi/userfunc",method:"put",data:{uid:t,tree_id:r,func_id:i,project_id:o,Permission_parameters:n}})}function g(e){var t=e.group_id,r=e.tree_id,i=e.project_id,a=void 0===i?2:i,o=e.Permission_parameters;return Object(l["a"])({url:"/AuthorityApi/groupfunc",method:"DELETE",data:{group_id:t,tree_id:r,project_id:a,Permission_parameters:o}})}function v(e){var t=e.uid,r=e.tree_id,i=e.project_id,a=void 0===i?2:i,o=e.Permission_parameters;return Object(l["a"])({url:"/AuthorityApi/userfunc",method:"DELETE",data:{uid:t,tree_id:r,project_id:a,Permission_parameters:o}})}function _(e){return Object(l["a"])({url:"/AuthorityApi/treegroup",method:"post",data:{tree_id:e}})}function b(e){var t=e.group_id,r=e.tree_id,i=e.func_id,a=e.project_id,o=void 0===a?2:a,n=e.Permission_parameters;return Object(l["a"])({url:"/AuthorityApi/groupfunc",method:"POST",data:{group_id:t,tree_id:r,func_id:i,project_id:o,Permission_parameters:n}})}function y(e){return Object(l["a"])({url:"/AuthorityApi/groupuseradd",method:"POST",data:{username:e}})}function j(e){var t=e.tree_id,r=e.uid,i=e.type,a=void 0===i?2:i;return Object(l["a"])({url:"/AuthorityApi/checkgroupuser",method:"post",data:{tree_id:t,uid:r,type:a}})}function F(e){var t=e.uid,r=e.tree_id,i=e.func_id,a=e.project_id,o=void 0===a?2:a,n=e.Permission_parameters;return Object(l["a"])({url:"/AuthorityApi/userfunc",method:"POST",data:{uid:t,tree_id:r,func_id:i,project_id:o,Permission_parameters:n}})}function S(e){return Object(l["a"])({url:"/AuthorityApi/envip",method:"get",params:{ip_type:e}})}var x=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-card",{attrs:{header:"编辑脚本"}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("脚本编辑")]),e._v(" "),r("span",{staticStyle:{float:"right"},attrs:{type:"text"}},[e._v("项目名称: "+e._s(e.currentNodeName))])]),e._v(" "),r("div",{staticClass:"configTitle"},[r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:14}},[r("h3",[e._v("脚本配置")])]),e._v(" "),r("el-col",{attrs:{span:5}},[3===e.curScript.file_type?r("div",[r("el-button",{attrs:{type:"primary",icon:"el-icon-plus",size:"small"},on:{click:e.addLoginFace}},[e._v("增加登录接口")])],1):e._e()]),e._v(" "),r("el-col",{attrs:{span:5}},[3===e.curScript.file_type?r("div",[r("el-button",{attrs:{type:"primary",size:"small",icon:"el-icon-plus"},on:{click:e.addFace}},[e._v("增加接口")])],1):e._e()])],1)],1),e._v(" "),r("loginFaceForm",{ref:"loginFaceForm",attrs:{"form-list":e.loginFormArr},on:{del:e.delLoginFace,getForm:e.getloginForm,uploaddata:e.getuploaddata}}),e._v(" "),r("comFaceForm",{ref:"comFaceForm",attrs:{"form-list":e.comfaceArr,"cur-script":e.curScript,"user-env":e.userEnv,"uri-ip-list":e.uriIpList},on:{getForm:e.getcomForm,uploaddatalist:e.getuploaddatalist}}),e._v(" "),"admin"===e.curScript.tree_authority||-1!==e.curScript.tree_authority.indexOf(14)?r("el-button",{attrs:{type:"primary",disabled:!e.canCreateScript},on:{click:e.handleGenerationScript}},[e._v("生成脚本")]):e._e(),e._v(" "),r("el-button",{on:{click:function(t){e.editScriptVisible=!1}}},[e._v("取 消")]),e._v(" "),r("div",{staticClass:"console"},[r("consoleConfig",{ref:"consoleConfig",attrs:{"cur-script":e.curScript,"form-data":e.consoleConfigForm,"is-runing":!!e.loading,"can-run":e.filename},on:{timerfun:e.timerfun,getForm:e.getConfigForm}})],1),e._v(" "),2===this.curScript.file_type?r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("日志详情")])]),e._v(" "),r("el-progress",{attrs:{"text-inside":!0,"stroke-width":24,percentage:e.percentage}}),e._v(" "),r("br"),e._v(" "),r("div",[e._v(e._s(e.logname))]),e._v(" "),r("br"),e._v(" "),r("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:10}},model:{value:e.logContent,callback:function(t){e.logContent=t},expression:"logContent"}})],1):e._e()],1),e._v(" "),r("timerdialog",{ref:"timerdialog"})],1)},k=[],A=r("db72"),O=(r("a481"),r("ad4b")),w=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"in-coder-panel"},[r("textarea",{ref:"textarea"})])},C=[],P=(r("7514"),r("56b3")),$=r.n(P),N=(r("a7be"),r("a8d9"),r("f9d4"),r("7b00"),r("d5e0"),r("4ba6"),r("959b"),r("db91"),r("903e"),r("02f0"),r("ffda"),r("c0e2"),r("693d"),window.CodeMirror||$.a),V={name:"in-coder",props:{value:String,language:{type:String,default:null},PropCode:{default:""}},watch:{PropCode:{handler:function(e,t){console.log(e),this.code=e},immediate:!0}},data:function(){return{code:"",mode:"Python",coder:null,options:{tabSize:2,theme:"cobalt",lineNumbers:!0,line:!0},modes:[{value:"css",label:"CSS"},{value:"javascript",label:"Javascript"},{value:"html",label:"XML/HTML"},{value:"x-java",label:"Java"},{value:"x-objectivec",label:"Objective-C"},{value:"x-python",label:"Python"},{value:"x-rsrc",label:"R"},{value:"x-sh",label:"Shell"},{value:"x-sql",label:"SQL"},{value:"x-swift",label:"Swift"},{value:"x-vue",label:"Vue"},{value:"markdown",label:"Markdown"}]}},mounted:function(){this._initialize()},methods:{_initialize:function(){var e=this;if(this.coder=N.fromTextArea(this.$refs.textarea,this.options),this.coder.setValue(this.value||this.code),this.coder.on("change",(function(t){e.code=t.getValue(),e.$emit&&(e.$emit("input",e.code),e.$emit("getVal",e.code))})),this.language){var t=this._getLanguage(this.language);t&&(this.mode=t.label)}},_getLanguage:function(e){return this.modes.find((function(t){var r=e.toLowerCase(),i=t.label.toLowerCase(),a=t.value.toLowerCase();return i===r||a===r}))},changeMode:function(e){this.coder.setOption("mode","text/".concat(e));var t=this._getLanguage(e).label.toLowerCase();this.$emit("language-change",t)}}},R=V,T=r("2877"),L=Object(T["a"])(R,w,C,!1,null,null,null),E=L.exports,I=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"loginfaceform"}},[r("el-form",{ref:"loginForm",attrs:{model:e.dynamicValidateForm,"label-width":"100px"}},e._l(e.dynamicValidateForm.loginFormArr,(function(t,i){return r("el-card",{directives:[{name:"show",rawName:"v-show",value:e.dynamicValidateForm.loginFormArr.length>0,expression:"dynamicValidateForm.loginFormArr.length>0"}],key:i,staticStyle:{"margin-bottom":"20px"},attrs:{header:"登录接口"}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("登录接口")]),e._v(" "),r("el-button",{staticStyle:{float:"right",margin:"5px"},attrs:{type:"warning",icon:"el-icon-delete",size:"mini"},on:{click:e.open}},[e._v("删除")]),e._v(" "),r("el-button",{staticStyle:{float:"right",margin:"5px"},attrs:{type:"primary",size:"mini",plain:""},on:{click:function(t){e.isShow=!e.isShow}}},[e._v(e._s(e.isShow?"收起 ⬆":"详情 ⬇"))])],1),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:e.isShow,expression:"isShow"}],staticClass:"content"},[r("el-row",[r("el-col",{attrs:{span:12}},[r("el-form-item",{attrs:{label:"请求类型",prop:"loginFormArr."+i+".meth",rules:[{required:!0,message:"请选择请求类型",trigger:"blur"}]}},[r("el-select",{attrs:{placeholder:"请选择请求类型"},model:{value:t.meth,callback:function(r){e.$set(t,"meth",r)},expression:"item.meth"}},e._l(["POST","GET"],(function(e){return r("el-option",{key:e+"reqtype",attrs:{label:e,value:e}})})),1)],1)],1),e._v(" "),r("el-col",{attrs:{span:11,offset:1}},[r("el-form-item",{attrs:{label:"路由地址",prop:"loginFormArr."+i+".hostpath",rules:[{required:!0,message:"请输入路由地址",trigger:"blur"},{validator:e.validIsURL,trigger:"change"}]}},[r("el-input",{model:{value:t.hostpath,callback:function(r){e.$set(t,"hostpath",r)},expression:"item.hostpath"}})],1)],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"接口参数",prop:"loginFormArr."+i+".parameter",rules:[{required:!0,validator:e.validateJson,trigger:"change"}]}},[r("el-input",{attrs:{type:"textarea"},model:{value:t.parameter,callback:function(r){e.$set(t,"parameter",r)},expression:"item.parameter"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"loginFormArr."+i}},[r("el-upload",{attrs:{name:"Filename",action:"http://quality-test.xueba100.com/RestfulFile/Upload","on-success":e.uploadsuccessed,"on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,multiple:"",limit:1,"on-exceed":e.handleExceed,"file-list":e.fileList}},[r("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("上传文件不能超过500kb")])],1),e._v(" "),r("div",{staticClass:"upload"},[r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dynamicValidateForm.loginFormArr}},[r("el-table-column",{attrs:{prop:"filename",label:"文件名",width:"280"}}),e._v(" "),r("el-table-column",{attrs:{prop:"msg",label:"上传状态",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{prop:"txt_count",label:"文件行数"}})],1)],1)],1)],1)])})),1)],1)},G=[],D=r("61f7"),q={name:"loginFaceForm",props:{formList:{default:[]}},data:function(){return{fileList:[],isShow:!0,dynamicValidateForm:{loginFormArr:[{meth:"POST",parameter:"",hostpath:"",uploadid:"1",filename:"",txt_count:"",msg:""}]},loginFormArr:[],formItem:{meth:"POST",parameter:"",hostpath:""}}},computed:{},watch:{formList:{deep:!0,handler:function(e,t){this.dynamicValidateForm={loginFormArr:Object(o["a"])(this.formList)}}}},created:function(){this.dynamicValidateForm={loginFormArr:Object(o["a"])(this.formList)}},methods:{uploadsuccessed:function(e,t,r){if(200!==e.statusCode)return this.$message.warning("上传文件失败");200===e.statusCode&&(this.dynamicValidateForm.loginFormArr[0].uploadid="2",this.dynamicValidateForm.loginFormArr[0].txt_count=e.txt_count,this.dynamicValidateForm.loginFormArr[0].uploadfilename=e.filename,this.dynamicValidateForm.loginFormArr[0].msg=e.msg,this.$message.success(e.msg)),this.$emit("uploaddata",this.dynamicValidateForm.loginFormArr[0]),console.log(this.dynamicValidateForm.loginFormArr[0])},handlePreview:function(e){console.log(e)},handleRemove:function(e,t){console.log(e),console.log(t)},handleExceed:function(e,t){console.log(e),console.log(t),this.$message.warning("当前限制选择 1 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},beforeRemove:function(e,t){return this.$confirm("确定移除 ".concat(e.name,"？"))},open:function(){var e=this;this.$confirm("此操作将删除此接口，保存后生效, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){e.$emit("del"),e.$message({type:"success",message:"删除成功!"})})).catch((function(){e.$message({type:"info",message:"已取消删除"})}))},validateJson:function(e,t,r){""===t?r(new Error("请输入接口参数")):Object(D["c"])(t)?r():r(new Error("请检查接口参数")),r()},validIsURL:function(e,t,r){console.log(t,"validateJson"),""===t?r(new Error("请输入路由地址")):Object(D["g"])(t)?r():r(new Error("请输入正确的路由地址")),r()},subLoginForm:function(){var e=this;console.log(this.$refs.loginForm,"loginFormArr=="),this.$refs.loginForm&&this.$refs.loginForm.validate((function(t){if(!t)return console.log("error submit!!"),e.$emit("getForm",[]),!1;e.$emit("getForm",e.dynamicValidateForm.loginFormArr)}))}}},z=q,B=Object(T["a"])(z,I,G,!1,null,"67d914e0",null),J=B.exports,M=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"comfaceform"}},[e.dynamicValidateForm.comFormArr.length>0?r("el-form",{ref:"comForm",attrs:{model:e.dynamicValidateForm,"label-width":"80px"}},[e._l(e.dynamicValidateForm.comFormArr,(function(t,i){return r("el-card",{directives:[{name:"show",rawName:"v-show",value:e.dynamicValidateForm.comFormArr.length>0,expression:"dynamicValidateForm.comFormArr.length>0"}],key:i,staticStyle:{"margin-bottom":"20px"},attrs:{header:"接口"}},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("接口")]),e._v(" "),r("el-button",{staticStyle:{float:"right",margin:"5px"},attrs:{type:"warning",icon:"el-icon-delete",size:"mini"},on:{click:function(t){return e.open(i)}}},[e._v("删除")]),e._v(" "),r("el-button",{staticStyle:{float:"right",margin:"5px"},attrs:{type:"primary",size:"mini",plain:""},on:{click:function(r){return e.showDetail(t)}}},[e._v(e._s(t.isShow?"收起 ⬆":"详情 ⬇"))])],1),e._v(" "),r("div",{directives:[{name:"show",rawName:"v-show",value:t.isShow,expression:"form.isShow"}],staticClass:"content"},[r("el-row",[r("el-col",{attrs:{span:10}},[r("el-form-item",{attrs:{label:"请求类型",prop:"comFormArr."+i+".type",rules:[{required:!0,message:"请选择请求类型",trigger:"blur"}]}},[r("el-select",{attrs:{placeholder:"请选择请求类型"},model:{value:t.type,callback:function(r){e.$set(t,"type",r)},expression:"form.type"}},e._l(["POST","GET"],(function(e){return r("el-option",{key:e+"reqtype",attrs:{label:e,value:e}})})),1)],1)],1),e._v(" "),r("el-col",{attrs:{span:11,offset:1}},[r("el-form-item",{attrs:{label:"压测环境",rules:[{required:!0,message:"请选择压测环境",trigger:"blur"}]}},[r("el-select",{attrs:{placeholder:"压测环境",prop:"comFormArr."+i+".test_env"},on:{change:function(r){return e.getUri(t,i)}},model:{value:t.test_env,callback:function(r){e.$set(t,"test_env",r)},expression:"form.test_env"}},e._l(e.userEnv,(function(t){return r("el-option",{key:t,attrs:{value:Number(t),label:e.envList[t]}})})),1)],1)],1)],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:10}},[r("el-form-item",{attrs:{label:"选择协议",prop:"comFormArr."+i+".selectHttp",rules:[{required:!0,message:"请选择协议",trigger:"blur"}]}},[r("el-select",{attrs:{placeholder:"选择协议"},model:{value:t.selectHttp,callback:function(r){e.$set(t,"selectHttp",r)},expression:"form.selectHttp"}},e._l(["http","https"],(function(e){return r("el-option",{key:e+"netType",attrs:{label:e,value:e}})})),1)],1)],1),e._v(" "),r("el-col",{attrs:{span:11}},[r("el-form-item",{attrs:{label:"uri",prop:"comFormArr."+i+".hostip",rules:[{required:!0,message:"请选择uri",trigger:"blur"}]}},[r("el-select",{attrs:{placeholder:"请选择uri"},model:{value:t.hostip,callback:function(r){e.$set(t,"hostip",r)},expression:"form.hostip"}},e._l(t.uriIpList,(function(e){return r("el-option",{key:e.id,attrs:{value:e.ip_name,label:e.ip_name}})})),1)],1)],1)],1),e._v(" "),r("el-form-item",{attrs:{label:"路由地址",prop:"comFormArr."+i+".hostpath",rules:[{required:!0,validator:e.validIsRoute,message:"请输入正确的路由地址",trigger:"blur"}]}},[r("el-input",{model:{value:t.hostpath,callback:function(r){e.$set(t,"hostpath",r)},expression:"form.hostpath"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"接口参数",prop:"comFormArr."+i+".parameter",rules:[{validator:e.validateJson,required:!0,trigger:"change"}]}},[r("el-input",{attrs:{type:"textarea"},model:{value:t.parameter,callback:function(r){e.$set(t,"parameter",r)},expression:"form.parameter"}})],1),e._v(" "),r("div",{staticClass:"upload"},[r("el-upload",{attrs:{name:"Filename",action:"http://quality-test.xueba100.com/RestfulFile/Upload","on-success":function(t,r,a){e.uploadsuccessed(t,r,a,i)},"on-preview":e.handlePreview,"on-remove":e.handleRemove,"before-remove":e.beforeRemove,multiple:"",limit:1,"on-exceed":e.handleExceed}},[r("el-button",{attrs:{size:"small",type:"primary"}},[e._v("点击上传")]),e._v(" "),r("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("上传文件不能超过500kb")])],1),e._v(" "),r("el-table",{staticStyle:{width:"100%"},attrs:{data:e.dynamicValidateForm.comFormArr}},[r("el-table-column",{attrs:{prop:"uploadfilename",label:"当前上传文件名",width:"280"}}),e._v(" "),r("el-table-column",{attrs:{prop:"uploadmsg",label:"上传状态",width:"180"}}),e._v(" "),r("el-table-column",{attrs:{prop:"uploadtxt_count",label:"文件行数"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"comFormArr."+i+".canshu"}},[r("addinput",{staticClass:"addinput",attrs:{val1:t.canshu},on:{addparams:function(t){e.getaddparams(t,i)}}})],1)],1),e._v(" "),3===e.curScript.file_type?r("el-form-item",{attrs:{label:"声明全局变量",prop:"comFormArr."+i+".selectHttp",rules:[{required:!1,message:"代码不能为空",trigger:"blur"}]}},[r("editor",{attrs:{height:30,PropCode:t.stateParams},on:{getVal:function(t){e.handdleGlobalParams(t,i,"stateParams")}}})],1):e._e(),e._v(" "),3===e.curScript.file_type?r("el-form-item",{attrs:{label:"传入全局变量",prop:"comFormArr."+i+".inParams",rules:[{required:!1,message:"代码不能为空",trigger:"blur"}]}},[r("editor",{attrs:{height:30,PropCode:t.inParams},on:{getVal:function(t){e.handdleGlobalParams(t,i,"inParams")}}})],1):e._e(),e._v(" "),3===e.curScript.file_type?r("el-form-item",{attrs:{label:"取出全局变量",prop:"comFormArr."+i+".getParams",rules:[{required:!1,message:"代码不能为空",trigger:"blur"}]}},[r("editor",{attrs:{height:50,PropCode:t.getParams},on:{getVal:function(t){e.handdleGlobalParams(t,i,"getParams")}}})],1):e._e()],1)])})),e._v(" "),e._t("default")],2):e._e()],1)},H=[],U=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"addinput"}},[r("el-form",{ref:"dynamicValidateForm",staticClass:"demo-dynamic",attrs:{model:e.dynamicValidateForm,"label-width":"100px"}},[e._l(e.dynamicValidateForm.domains,(function(t,i){return r("el-form-item",{key:t.key,attrs:{label:"DATA"+i,prop:"domains."+i+".value",rules:{required:!0,message:"域名不能为空",trigger:"blur"}}},[r("el-input",{staticClass:"addinput",on:{input:function(t){return e.handle()}},model:{value:t.value,callback:function(r){e.$set(t,"value",r)},expression:"domain.value"}}),e._v(" "),r("el-button",{on:{click:function(r){return r.preventDefault(),e.removeDomain(t)}}},[e._v("删除")])],1)})),e._v(" "),r("el-form-item",[r("el-button",{on:{click:function(t){return e.addDomain()}}},[e._v("新增参数")]),e._v(" "),r("el-button",{on:{click:function(t){return e.resetForm("dynamicValidateForm")}}},[e._v("重置")])],1)],2)],1)},X=[],Q={props:["val1"],data:function(){return{dynamicValidateForm:{domains:[{value:"",data:"data[0]"}]}}},methods:{handle:function(){this.$emit("addparams",this.dynamicValidateForm.domains)},resetForm:function(e){this.$refs[e].resetFields()},removeDomain:function(e){var t=this.dynamicValidateForm.domains.indexOf(e);-1!==t&&this.dynamicValidateForm.domains.splice(t,1)},addDomain:function(){this.dynamicValidateForm.domains.push({value:"",data:"data["+this.dynamicValidateForm.domains.length+"]"})}},watch:{val1:function(e,t){this.dynamicValidateForm.domains=e}}},K=Q,W=(r("777c"),Object(T["a"])(K,U,X,!1,null,"39998457",null)),Y=W.exports,Z={name:"comFaceForm",props:{curScript:{type:Object,default:{file_type:3}},formList:{default:[]},userEnv:{type:Array,default:[]}},components:{Editor:E,addinput:Y},data:function(){return{uploaddatalist:[],uploaddata:[{filename:""}],dynamicValidateForm:{comFormArr:[{hostip:"",selectHttp:"",type:"",hostpath:"",test_env:"",uriIpList:[],parameter:"",stateParams:"",getParams:"",inParams:"",numParams:"",canshu:[{val:"",index:""}],uploadfilename:"",uploadtxt_count:"",uploadmsg:"",isupload:!1}]},envList:["测试环境","预发布环境","线上环境"]}},computed:{},watch:{formList:{deep:!0,handler:function(e,t){this.dynamicValidateForm={comFormArr:this.initlist(Object(o["a"])(this.formList))}}}},created:function(){this.dynamicValidateForm={comFormArr:this.initlist(Object(o["a"])(this.formList))}},methods:{getaddparams:function(e,t){console.log(e),console.log(t),this.dynamicValidateForm.comFormArr[t].canshu=e},inputchange:function(){this.$emit("uploaddatalist",this.uploaddatalist)},adduploadlist:function(){this.uploaddatalist.push({})},uploadsuccessed:function(e,t,r,i){if(console.log(e),console.log(t),console.log(r),this.dynamicValidateForm.comFormArr[i].uploadmsg="",200!==e.statusCode)return this.$message.warning("上传文件失败");200===e.statusCode&&(this.dynamicValidateForm.comFormArr[i].uploadfilename=e.filename,this.dynamicValidateForm.comFormArr[i].uploadtxt_count=e.txt_count,this.dynamicValidateForm.comFormArr[i].uploadmsg=e.msg,this.dynamicValidateForm.comFormArr[i].isupload=!0,this.uploaddata[0].msg=e.msg,this.uploaddata[0].txt_count=e.txt_count,this.uploaddata[0].filename=e.filename,this.$message.success(e.msg),console.log(this.uploaddata),this.$emit("uploaddata",this.uploaddata))},handlePreview:function(e){console.log(e)},handleRemove:function(e,t){console.log(e),console.log(t)},handleExceed:function(e,t){console.log(e),console.log(t),this.$message.warning("当前限制选择 1 个文件，本次选择了 ".concat(e.length," 个文件，共选择了 ").concat(e.length+t.length," 个文件"))},beforeRemove:function(e,t){return this.$confirm("确定移除 ".concat(e.name,"？"))},initlist:function(e){return e.map((function(e){return Object(A["a"])(Object(A["a"])({},e),{},{isShow:!0})}))},showDetail:function(e){e.isShow=!e.isShow},open:function(e){var t=this;this.$confirm("此操作将删除此接口，保存后生效, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){t.dynamicValidateForm.comFormArr.splice(e,1),t.$message({type:"success",message:"删除成功!"})})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},validateJson:function(e,t,r){""===t?r(new Error("请输入接口参数")):Object(D["c"])(t)?r():r(new Error("请检查接口参数")),r()},validIsRoute:function(e,t,r){console.log(t,"validIsRoute"),""===t?r(new Error("请输入路由地址")):Object(D["f"])(t)?r():r(new Error("请输入正确的路由地址")),r()},subcomForm:function(){var e=this;console.log(this.$refs.comForm,"comFormArr==",this.dynamicValidateForm.comFormArr),this.$refs.comForm&&this.$refs.comForm.validate((function(t){if(!t)return console.log("error submit!!"),e.$emit("getForm",[]),!1;e.$emit("getForm",e.dynamicValidateForm.comFormArr)}))},handdleGlobalParams:function(e,t,r){this.dynamicValidateForm.comFormArr[t][r]=e},getUri:function(e,t){var r=this;S(e.test_env).then((function(e){200===e.statusCode&&(r.dynamicValidateForm.comFormArr[t].uriIpList=e.data,r.$set(r.dynamicValidateForm.comFormArr[t],"uriIpList",e.data),console.log(r.dynamicValidateForm.comFormArr))}))}}},ee=Z,te=(r("1a5d"),Object(T["a"])(ee,M,H,!1,null,"095c130b",null)),re=te.exports,ie=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-card",{staticClass:"box-card"},[r("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[r("span",[e._v("控制台配置")])]),e._v(" "),r("el-form",{ref:"consoleForm",attrs:{"label-width":"100px",model:e.form,"label-position":"right"}},[r("div",{staticClass:"loadingContent"},[r("el-row",[r("el-col",{attrs:{span:12}},[r("div",{staticClass:"grid-content bg-purple"},[r("el-form-item",{attrs:{label:"并发数",prop:"concurrency",rules:[{required:!0,message:"请输入并发数",trigger:"change"}]}},[r("el-input",{model:{value:e.form.concurrency,callback:function(t){e.$set(e.form,"concurrency",t)},expression:"form.concurrency"}})],1)],1)]),e._v(" "),r("el-col",{attrs:{span:12}},[r("div",{staticClass:"grid-content bg-purple-light"},[r("el-form-item",{attrs:{label:"think time",prop:"thinkTime",rules:[{required:!1,message:"",trigger:"blur"}]}},[r("el-input",{attrs:{disabled:!0},model:{value:e.form.thinkTime,callback:function(t){e.$set(e.form,"thinkTime",t)},expression:"form.thinkTime"}})],1)],1)])],1),e._v(" "),r("el-row",[r("el-col",{attrs:{span:9}},[r("div",{staticClass:"grid-content bg-purple"},[r("el-form-item",{attrs:{label:"运行选择",prop:"strategy",rules:[{required:!0,message:"请选择运行方式",trigger:"change"}]}},[r("el-select",{attrs:{placeholder:"请选择运行方式"},model:{value:e.form.strategy,callback:function(t){e.$set(e.form,"strategy",t)},expression:"form.strategy"}},[r("el-option",{attrs:{label:"运行时间",value:"-t"}}),e._v(" "),r("el-option",{attrs:{label:"循环次数",value:"-l"}})],1)],1)],1)]),e._v(" "),r("el-col",{attrs:{span:6}},[r("div",{staticClass:"grid-content bg-purple-light"},[r("el-form-item",{attrs:{"label-width":"20",prop:"con_praameter",rules:[{required:!0,message:"请输入时间毫秒数或次数",trigger:"change"}],placeholder:"请输入时间毫秒数或次数"}},[r("el-input",{staticClass:"runTime",model:{value:e.form.con_praameter,callback:function(t){e.$set(e.form,"con_praameter",t)},expression:"form.con_praameter"}})],1)],1)])],1)],1),e._v(" "),r("el-form-item",["admin"===e.curScript.tree_authority||-1!==e.curScript.tree_authority.indexOf(15)?r("el-button",{attrs:{type:"primary",disabled:!e.isScriptName||e.isRun},on:{click:function(t){return e.subcomForm("run")}}},[e._v("运行\n        ")]):e._e(),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.handle}},[e._v("定时运行")]),e._v(" "),r("el-button",{attrs:{type:"primary",disabled:!e.isScriptName},on:{click:function(t){return e.subcomForm("end")}}},[e._v("结束")]),e._v(" "),r("el-button",{attrs:{type:"primary",disabled:!e.isScriptName},on:{click:function(t){return e.subcomForm("save")}}},[e._v("保存")])],1)],1)],1)],1)},ae=[],oe={name:"EditScript",props:{canRun:{type:String,default:""},isRuning:{type:Boolean,default:!1},curScript:{type:Object,default:{file_type:3}},formData:{type:Object,default:{concurrency:"",con_praameter:"",strategy:"",thinkTime:""}}},data:function(){return{form:{concurrency:"",con_praameter:"",strategy:"",thinkTime:""},isScriptName:!1,isRun:!1}},watch:{formData:{deep:!0,handler:function(e,t){this.form=Object(A["a"])({},e)}},canRun:{deep:!0,handler:function(e,t){this.isScriptName=!!e}},isRuning:{deep:!0,handler:function(e,t){this.isRun=!!e}}},created:function(){this.form=Object(A["a"])({},this.formData),this.isScriptName=!!this.canRun,this.isRun=!!this.isRuning,console.log("是否可运行",this.isScriptName)},methods:{handle:function(){this.$emit("timerfun")},subcomForm:function(e){var t=this;console.log(this.$refs.consoleForm,"comFormArr==",e),this.$refs.consoleForm&&this.$refs.consoleForm.validate((function(r){if(!r)return console.log("error submit!!"),!1;t.$emit("getForm",{opt:e,data:t.form})}))}}},ne=oe,se=Object(T["a"])(ne,ie,ae,!1,null,"130f4960",null),le=se.exports;r("a78e"),r("2d63");var ce={name:"EditScript",components:{timerdialog:O["a"],Editor:E,loginFaceForm:J,comFaceForm:re,consoleConfig:le},props:{currentNodeName:{default:""},curScript:{default:{}},curNode:{default:{}},editNode:{default:{}},scriptVisible:{type:Boolean,default:!1},userEnv:{type:Array,default:[]}},data:function(){return{timerdata:[{username:"",firstlevel:""}],logdataname:{username:""},uploaddatalist:[],script4:[],uploaddata:{uploadfilename:"",txt_count:"",msg:""},scriptFirstReq:{typeid:"1",sclist:[]},fileconnect:[],canCreateScript:!0,loading:null,consoleConfigForm:{con_praameter:"",strategy:"",thinkTime:"",concurrency:""},loginFormArr:[{meth:"",hostpath:"",parameter:"",filename:"",txt_count:"",uploadid:"1"}],logininfo:{uploadid:""},comfaceArr:[{hostip:"",selectHttp:"",type:"",meth:"",hostpath:"",test_env:"",uriIpList:[],parameter:"",stateParams:"",inParams:"",getParams:"",numParams:"",canshu:[],uploadmsg:"",uploadfilename:"",uploadtxt_count:"",isupload:""}],editScriptVisible:!1,form:{meth:"POST"},uriIpList:[],isScriptName:!1,logname:"",logContent:"",isRun:!0,generationScriptName:"",clock:null,logClock:null,percentage:0,filename:"",scriptslog:"",clockLog:null}},watch:{scriptVisible:{deep:!0,handler:function(e,t){this.editScriptVisible=this.scriptVisible}},curNode:{deep:!0,handler:function(e,t){console.log(e,"curNode=="),this.setInitData()}},"editNode.data":{deep:!0,handler:function(e,t){console.log(e,"editNode=="),this.setInitData()}}},created:function(){this.setInitData()},methods:{timerfun:function(){console.log("timer已经触发"),this.$refs.timerdialog.dialogTableVisible=!0,this.timerdata[0].username=window.localStorage.getItem("username").slice(0,window.localStorage.getItem("username").indexOf("@")),console.log(this.timerdata[0])},getuploaddatalist:function(e){this.uploaddatalist=e,console.log(e,"添加所有表单的值")},strfun:function(){var e=[],t=[],r=[];this.comfaceArr.forEach((function(i,a){(i.canshu||[]).forEach((function(e){var t='\n            phone_no = data[0] -x-#替换phone_no为参数1的，第一个是0\n            scdata["phone_no"] = str(phone_no) -x-#替换phone_no为参数1\n        ';t=t.replace(/phone_no/g,e.value),t=t.replace(/data\[0\]/g,e.data),t=t.split("-x-"),r=[].concat(Object(o["a"])(r),Object(o["a"])(t))}));var n='\n        if scpath == "路由地址":  -x-#传入参数 \n            data = file.get()    -x-#file文件名去后缀\n        ';n=n.replace(/路由地址/g,i.hostpath);var s=i.uploadfilename.substring(0,i.uploadfilename.length-4);console.log(s,"这个是name这个是name这个是name这个是name这个是name这个是name这个是name"),n=""===s?"":n.replace(/file/g,s),n=n.split("-x-"),t=[].concat(Object(o["a"])(t),Object(o["a"])(n));var l="\nfilename = Queue()-x-\ntxtnum = int('numtxt')-x-\nscriptspath = filepath + 'filename' + '.txt'-x-\nfiledata1(translation,filename,scriptspath,txtnum)-x-\n";l=""===s?"":l.replace(/filename/g,s),l=l.replace(/numtxt/g,i.uploadtxt_count),l=l.split("-x-"),e=[].concat(Object(o["a"])(e),Object(o["a"])(l))})),this.script5=[].concat(Object(o["a"])(t),Object(o["a"])(r)),this.script4=e,console.log(e)},setInitData:function(){var e=window.localStorage.getItem("username"),t=e.slice(0,e.indexOf("@")).replace(".","");this.logdataname.username=t;t="/mnt/fulllinklogs/datalogs/test_environmen/datalogs-"+t+".log";this.form=Object(A["a"])({},this.editNode.data),console.log(this.editNode.data),console.log(this.form.link_parameters);var r=this.form.link_parameters?JSON.parse(this.form.link_parameters):"";this.comfaceArr=r.comfaceArr||this.comfaceArr,this.loginFormArr=r.loginFormArr||this.loginFormArr,this.consoleConfigForm=Object(A["a"])(Object(A["a"])({},this.consoleConfigForm),r.consoleConfigForm||{}),this.filename=r.filename,this.scriptslog=t},scCreate:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return console.log(2222),e.next=3,Object(s["q"])(t);case 3:r=e.sent,200==r.statusCode?(console.log(r,"res scCreate 单接口脚本生成"),this.filename=r.data.filename,console.log(this.filename,"单接口脚本生成的 filename  ==runImplementScript"),this.saveDetailtoTree(this.filename)):this.$message.error(r.msg);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),getScTemlpte:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var r,i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["k"])(t);case 2:r=e.sent,console.log(r,"第一步 根据表单信息 获取脚本模版"),200==r.statusCode?(this.fileconnect=r.data.fileconnect,console.log(this.fileconnect,"fileconnect第一次发来的脚本"),i=this.addScTemplate(this.fileconnect),console.log(i,"templateArr"),this.createScTemlpte({filecontent:i,username:window.localStorage.getItem("username").split("@")[0].split(".").join("")})):this.$message.error(r.msg);case 5:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),createScTemlpte:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var r,i,a;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["l"])(t);case 2:r=e.sent,200==r.statusCode?(this.filename=r.data.scriptsname,console.log(r.data,"这个是res。data这个是res。data这个是res。data这个是res。data这个是res。data这个是res。data这个是res。data这个是res。data"),i=window.localStorage.getItem("username"),a=i.slice(0,i.indexOf("@")).replace(".",""),this.logdataname.username=a,a="/mnt/fulllinklogs/datalogs/test_environmen/datalogs-"+a+".log",this.scriptslog=a,console.log(r,"第二步 根据表单信息 和 模版 拼接后 生成脚本"),this.saveDetailtoTree(r.data.scriptsname)):this.$message.error(r.msg);case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),saveDetailtoTree:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var r,i,a,o;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(console.log(t,"fname runImplementScript saveDetailtoTree"),r=this.curNode,i=1;i<this.curNode.level;i++)r=r.parent;return a=Object(A["a"])(Object(A["a"])({sc_name:t||this.filename,link_parameters:JSON.stringify({loginFormArr:this.loginFormArr,comfaceArr:this.comfaceArr,consoleConfigForm:this.consoleConfigForm,filename:t||this.filename,scriptslog:this.scriptslog}),concurrency:this.form.concurrency,con_praameter:this.form.con_praameter,strategy:this.form.strategy,id:this.form.id,filename:this.form.label,file_type:this.form.file_type},this.consoleConfigForm),{},{Permission_parameters:{type:2,tree_id:r.data.id,uid:this.$store.state.user.uid}}),console.log(t,a,"fname runImplementScript saveDetailtoTree"),e.next=7,Object(s["r"])(a);case 7:o=e.sent,200===o.statusCode?(console.log("updataTreeData"),this.$message({message:o.msg,type:"success"})):this.$message({message:o.msg,type:"warning"});case 9:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),handleEndScript:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,Object(s["c"])();case 2:t=e.sent,200===t.statusCode?(clearInterval(this.clock),this.$message({message:t.msg,type:"success"})):this.$message({message:t.msg,type:"warn"});case 4:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),checkLog:function(){var e=this;this.clockLog=setInterval((function(){console.log(e.filename,"这个是filename这个是filename这个是filename这个是filename这个是filename这个是filename这个是filename"),Object(s["b"])({scriptname:[e.filename]}).then((function(t){console.log(t,"CheckLogComplete"),200===t.statusCode?0==t.status&&(clearInterval(e.clockLog),e.clockLog=null,setTimeout((function(){Object(s["g"])({file_name:e.scriptslog}).then((function(t){if(200===t.statusCode){var r="";return t.data.data_list.map((function(e,t){r+=e+"  "})),Object(s["o"])({useremail:window.sessionStorage.getItem("username"),datamsg:r}),e.$message({message:"运行成功，邮件已发送",type:"success"}),e.loading&&e.loading.close(),e.loading=null,e.canCreateScript=!0,!0}e.$message({message:t.msg,type:"warn"}),e.loading&&e.loading.close(),e.loading=null,e.canCreateScript=!0}))}),5e3)):e.$message.error(t.msg)}))}),1e4)},tranIp:function(e){return-1===(e||"").indexOf("http")?e:e.split("//")[1].split("/")[0]},runImplementScript:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(t){var r,i,a,o,n,l,c,u,d=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(r=this.consoleConfigForm,i=r.strategy,a=r.con_praameter,o=r.concurrency,n=this.curNode,l=1;l<this.curNode.level;l++)n=n.parent;return c={Permission_parameters:{type:2,tree_id:n.data.id,uid:this.$store.state.user.uid},Filename:t,Concurrent:o,Dx:i,Xz:a,Ip:this.tranIp(this.comfaceArr[0].hostip)||"crm-pre.wenba100.com"},e.next=6,Object(s["n"])(c);case 6:u=e.sent,"200"==u.statusCode?(console.log(this.filename,t,"单接口脚本执行getLog runImplementScript",u),setTimeout((function(){d.logClock=setInterval((function(){return d.getLog(t)}),3e3)}),5e3)):this.$message.error(u.msg);case 8:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),runScript:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,r,i,a,o,n,l,c,u,d=this;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:for(t=this.consoleConfigForm,r=t.strategy,i=t.con_praameter,a=t.concurrency,o=this.comfaceArr.map((function(e,t){return{Filename:d.filename,Concurrent:a,Dx:r,Xz:i,Ip:d.tranIp(e.hostip)||"crm-pre.wenba100.com"}})),n=this.curNode,l=1;l<this.curNode.level;l++)n=n.parent;return c={data:[o[0]],Permission_parameters:{type:2,tree_id:n.data.id,uid:this.$store.state.user.uid}},e.next=7,Object(s["e"])(this.logdataname);case 7:return e.sent,e.next=10,Object(s["a"])(c);case 10:u=e.sent,this.percentage=0,"200"==u.statusCode?setTimeout((function(){d.checkLog()}),5e3):this.$message.error(u.msg);case 13:case"end":return e.stop()}}),e,this)})));function t(){return e.apply(this,arguments)}return t}(),getloginForm:function(e){if(console.log(e,"登录类型接口 表单数据"),e.length>0){var t={typeid:"2",login_data:e[0].parameter,login_url:e[0].hostpath};this.scriptFirstReq=Object(A["a"])(Object(A["a"])({},this.scriptFirstReq),t)}},getcomForm:function(e){console.log(e,"获取 普通类型接口 表单数据"),this.comfaceArr=Object(o["a"])(e),this.scriptFirstReq=Object(A["a"])(Object(A["a"])({},this.scriptFirstReq),{},{sclist:Object(o["a"])(e)})},getConfigForm:function(e){console.log(e,"获取 控制台配置 表单数据"),this.consoleConfigForm=Object(A["a"])({},e.data),"run"==e.opt&&(this.loading=this.$loading({customClass:"loading",lock:!0,target:".loadingContent",text:"脚本运行中...",spinner:"el-icon-loading",background:"rgba(255, 255, 255, .3)"}),this.canCreateScript=!1,this.$refs.comFaceForm.subcomForm(),this.$refs.loginFaceForm.subLoginForm(),this.scriptFirstReq.sclist.length>0?3===this.form.file_type?this.runScript():(this.logContent="",this.logname="",this.percentage=0,console.log(this.filename,"执行之前取到的 filename  ==runImplementScript"),this.runImplementScript(this.filename)):(this.$message({message:"接口数为0 或 存在未填项",type:"error"}),this.loading&&this.loading.close(),this.loading=null,this.canCreateScript=!0)),"save"==e.opt||"run"==e.opt?this.saveDetailtoTree():this.handleEndScript()},addLoginFace:function(){0===this.loginFormArr.length?this.loginFormArr.push({meth:"",hostpath:"",parameter:"",filename:"",txt_count:"",uploadid:"1"}):this.$message("登录接口已添加")},delLoginFace:function(){this.loginFormArr=[]},addFace:function(){var e={hostip:"",selectHttp:"",type:"",hostpath:"",test_env:"",uriIpList:[],parameter:"",stateParams:"",getParams:"",numParams:"",inParams:""};this.comfaceArr.push(Object(A["a"])({},e))},tranJson:function(e){return(e||[]).map((function(e,t){return console.log(e.parameter,"item.parameter"),Object(A["a"])(Object(A["a"])({},e),{},{parameter:JSON.parse(e.parameter.replace(/\n/g,""))})}))},getuploaddata:function(e){this.logininfo.uploadid=void 0===e?"1":e.upload,this.logininfo.txt_count=void 0===e?"":JSON.stringify(e.txt_count),this.logininfo.uploadfilename=void 0===e?"":e.uploadfilename,console.log(e,"这个是val"),console.log(this.logininfo,"这个是uploaddata")},handleGenerationScript:function(){this.getuploaddata(),console.log(1),this.$refs.comFaceForm.subcomForm(),this.$refs.loginFaceForm.subLoginForm();for(var e=this.curNode,t=1;t<this.curNode.level;t++)e=e.parent;if(this.scriptFirstReq.sclist.length>0){console.log(2),console.log(this.scriptFirstReq,this.loginFormArr[0],"this.scriptFirstReq");var r=Object(A["a"])(Object(A["a"])(Object(A["a"])({},this.scriptFirstReq),{},{sclist:this.tranJson(this.scriptFirstReq.sclist)},this.loginFormArr[0]),{},{uploadid:void 0===this.loginFormArr[0]?"1":this.loginFormArr[0].uploadid});if(3===this.form.file_type)console.log(3),console.log(r),this.getScTemlpte(r);else{console.log(4),console.log(this.$store.state.user.uid);var i=Object(A["a"])({Permission_parameters:{type:2,tree_id:e.data.id,uid:window.localStorage.getItem("uid")},userName:window.localStorage.getItem("username").split("@")[0].split(".").join("")},r.sclist[0]);console.log(i,"这个是req----------------------"),this.scCreate(i)}}else this.$message({message:"接口数为空 或 存在未填项",type:"error"}),this.loading&&this.loading.close(),this.loading=null,this.canCreateScript=!0},addScTemplate:function(e){var t=this,r=[];return e.forEach((function(e,i){if(-1!==e.indexOf("takeparameters1")){var a=t.addScParams("stateParams",e);r.push.apply(r,Object(o["a"])(a))}if(-1!==e.indexOf("takeparameters2")){var n=t.addScParams("inParams",e);r.push.apply(r,Object(o["a"])(n))}if(-1!==e.indexOf("takeparameters3")){console.log(t.addScParams("getParams",e),"这个是第三个换成的内容this.addScParams(getParams, item)");var s=t.addScParams("getParams",e);r.push.apply(r,Object(o["a"])(s))}if(-1!==e.indexOf("takeparameters4")){t.strfun(),console.log(t.script4,"替换完的脚本");r.push.apply(r,Object(o["a"])(t.script4))}if(-1!==e.indexOf("takeparameters5")){console.log("第五部分替换位置第五部分替换位置第五部分替换位置第五部分替换位置第五部分替换位置第五部分替换位置第五部分替换位置"),t.strfun();r.push.apply(r,Object(o["a"])(t.script5))}-1==e.indexOf("takeparameters1")&&-1==e.indexOf("takeparameters2")&&-1==e.indexOf("takeparameters3")&&-1==e.indexOf("takeparameters4")&&-1==e.indexOf("takeparameters5")&&r.push(e)})),r},replaceParameter:function(e,t,r){var i=[];return e=e.replace(/\n/g,"\n").split("\n"),e.forEach((function(e){i.push(t.substring(0,8)+e+"\n")})),i},addScParams:function(e,t){var r=this,i=[];return(this.scriptFirstReq.sclist||[]).map((function(a,n){i.push.apply(i,Object(o["a"])(r.replaceParameter(a[e]||"",t,e)))})),i},getLog:function(e){var t=this,r=[{scriptname:e}];Object(s["h"])(r).then((function(r){200===r.statusCode?"null"===r.data.resultlog?(t.loading&&t.loading.close(),t.loading=null,t.canCreateScript=!0,t.percentage=100,clearInterval(t.logClock),t.getLogResult(e)):(t.percentage<99&&(t.percentage=t.percentage+parseInt(10*Math.random())),t.logContent=r.data.resultlog[0].logconet,t.logname=r.data.resultlog[0].logname):(t.loading.close(),t.loading=null,t.canCreateScript=!0,t.$message({message:r.msg||"执行脚本失败",type:"warning"}))}))},getLogResult:function(e){var t=this,r=[{scriptname:e}];Object(s["i"])(r).then((function(e){if(200===e.statusCode){t.logname=e.data.logname;var r=e.data.resultlog.slice(-8);console.log(r),t.logContent=r.join("; ")}else t.$message({message:e.msg,type:"warning"})}))}}},ue=ce,de=(r("83de"),Object(T["a"])(ue,x,k,!1,null,null,null)),me=de.exports,pe=r("1472"),fe={components:{EditScript:me},data:function(){return{emptyText:"",editStaffVisible:!1,editRightVisible:!1,addStaffVisible:!1,addGroupsVisible:!1,newProjectVisible:!1,labelList:[],groupsData:[],staffData:[],expandArr:[],isScriptName:!1,logname:"",logContent:"",setTimeTaskVisible:!1,editName:!0,editScriptContent:!0,editScriptNameVisible:!1,editScriptVisible:!1,creatScriptVisible:!1,editVisible:!1,creatVisible:!1,scriptBtn:"运行",treeDataList:[],currentType:"index",defaultProps:{children:"children",label:"label"},form:{staffRight:["1","3"],right:["1","3"],staffAccount:"",selStaffRight:[],selectGroup:"",selGroupRight:[],scriptName:"",filename:""},rules:{filename:[{required:!0,message:"请输入活动名称",trigger:["blur","change"]}]},currentNode:"",uid:"",creatBtn:!0,file_type:"",pid:0,editNode:"",popProject:!0,popScript:!0,creatTitle:"",currentNodeName:"",popwidth:"200px",generationScriptName:"",totalTime:"",percentage:0,clock:null,logClock:null,isFlag:!0,isRun:!0,curProject:{},curGroup:{},curStaff:{},groupListInAdd:[],selStaffAdd:{},envList:["预发布环境","测试环境","线上环境"],userEnv:[],curScript:{tree_authority:[]},curNode:{id:""},FullLinkVisible:!1,linkForm:{}}},created:function(){this.getTree(),console.log(this.$store.state.user)},methods:{handleEditStaff:function(e){this.curStaff=e,this.form.staffRight=e.func_id.map(Number),this.editStaffVisible=!0},handle:function(e,t){console.log(e.level),console.log(t)},editStaffRight:function(){var e=this;h({uid:this.curStaff.uid,tree_id:this.curProject.id,func_id:this.form.staffRight.join(","),Permission_parameters:{type:2,tree_id:this.curProject.id,uid:this.$store.state.user.uid}}).then((function(t){console.log(t),200===t.statusCode?(e.editStaffVisible=!1,e.getStaffFuncList(),e.$message({type:"success",message:t.msg})):e.$message.error(t.msg)}))},handleAddStaff:function(){this.addStaffVisible=!0},queryStaff:function(e,t){y(this.form.staffAccount).then((function(e){if(200===e.statusCode){t(e.data);var r=[];e.data.forEach((function(e){r.push({value:"".concat(null===e.name?"":e.name,"(").concat(e.username,")"),username:e.username,id:e.id,name:e.name})})),t(r)}}))},selStaff:function(e){var t=this;console.log(e),j({tree_id:this.curProject.id,uid:e.id,type:2}).then((function(r){200===r.statusCode?t.selStaffAdd=e:t.$message.error(r.msg)}))},cancleAddStaff:function(){this.addStaffVisible=!1,this.form.staffAccount="",this.form.selStaffRight=[]},addStaff:function(){var e=this;F({uid:this.selStaffAdd.id,tree_id:this.curProject.id,func_id:this.form.selStaffRight.join(","),Permission_parameters:{type:2,tree_id:this.curProject.id,uid:this.$store.state.user.uid}}).then((function(t){200===t.statusCode?(e.addStaffVisible=!1,e.getStaffFuncList(),e.form.staffAccount="",e.form.selStaffRight=[],e.$message({type:"success",message:t.msg})):e.$message.error(t.msg)}))},handleDeleteStaff:function(e){var t=this;console.log(e),this.$confirm("此操作将删除该员工, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){v({uid:e.uid,tree_id:t.curProject.id,Permission_parameters:{type:2,tree_id:t.curProject.id,uid:t.$store.state.user.uid}}).then((function(e){200===e.statusCode?(t.getStaffFuncList(),t.$message({type:"success",message:e.msg})):t.$message.error(e.msg)}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},handleEditGroup:function(e){this.curGroup=e,this.form.right=e.func_id.map(Number),this.editRightVisible=!0},editGroupRight:function(){var e=this;f({group_id:this.curGroup.group_id,tree_id:this.curProject.id,func_id:this.form.right.join(","),Permission_parameters:{type:2,tree_id:this.curProject.id,uid:this.$store.state.user.uid}}).then((function(t){console.log(t),200===t.statusCode?(e.editRightVisible=!1,e.getGroupFuncList(),e.$message({type:"success",message:t.msg})):e.$message.error(t.msg)}))},handleDeleteGroup:function(e){var t=this;this.curGroup=e,this.$confirm("此操作将删除该分组, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){g({group_id:t.curGroup.group_id,tree_id:t.curProject.id,Permission_parameters:{type:2,tree_id:t.curProject.id,uid:t.$store.state.user.uid}}).then((function(e){200===e.statusCode?(t.getGroupFuncList(),t.$message({type:"success",message:e.msg})):t.$message.error(e.msg)}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},handleAddGroup:function(){var e=this;this.addGroupsVisible=!0,_(this.curProject.id).then((function(t){200===t.statusCode&&(e.groupListInAdd=t.data)}))},cancleaddGroups:function(){this.addGroupsVisible=!1,this.form.selectGroup="",this.form.selGroupRight=[]},addGroupRight:function(){var e=this;b({group_id:this.form.selectGroup,tree_id:this.curProject.id,func_id:this.form.selGroupRight.join(","),Permission_parameters:{type:2,tree_id:this.curProject.id,uid:this.$store.state.user.uid}}).then((function(t){200===t.statusCode?(e.addGroupsVisible=!1,e.getGroupFuncList(),e.form.selectGroup="",e.form.selGroupRight=[],e.$message({type:"success",message:t.msg})):e.$message.error(t.msg)}))},handleNewProject:function(){this.newProjectVisible=!0},getGroupFuncList:function(){var e=this;d({tree_id:this.curProject.id,Permission_parameters:{type:2,tree_id:this.curProject.id,uid:this.$store.state.user.uid}}).then((function(t){if(200===t.statusCode){var r=[];t.data.forEach((function(e){r.push({group_id:e.group_id,group_name:e.group_name,func_id:e.func_id.split(",")})})),e.groupsData=r}}))},getStaffFuncList:function(){var e=this;m({tree_id:this.curProject.id,Permission_parameters:{type:2,tree_id:this.curProject.id,uid:this.$store.state.user.uid}}).then((function(t){if(200===t.statusCode){var r=[];t.data.forEach((function(e){r.push({uid:e.uid,name:e.name,username:e.username,func_id:e.func_id.split(",")})})),e.staffData=r}}))},handleProjectManage:function(e){var t=this;console.log(e);var r=e.data;this.curProject=r,p({Permission_parameters:{type:2,tree_id:r.id,uid:this.$store.state.user.uid}}).then(function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(r){var i;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(200!==r.statusCode){e.next=9;break}return i=[],r.data.forEach((function(e){i.push({label:e.func_name,func_id:e.id})})),t.labelList=i,e.next=6,t.getGroupFuncList();case 6:return e.next=8,t.getStaffFuncList();case 8:t.currentType="projectManage";case 9:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())},handleEditName:function(){this.editScriptNameVisible=!0},handleEditScript:function(e,t){var r=this;console.log(e),console.log(t),4===t.level&&(this.currentType="editScript",this.edit(t,e),this.curNode=t,this.curScript=t.data,null===this.editNode.data.sc_name&&""===this.generationScriptName?this.isScriptName=!0:this.isScriptName=!1,this.editScriptVisible=!0,Object(pe["s"])(this.$store.state.user.uid).then((function(e){200===e.statusCode&&(r.userEnv=e.data[0].ip_type)})),this.form.editScriptName=this.editNode.data.label,this.logContent="",this.logname="",this.percentage=0)},getLog:function(){var e=this,t="";t=this.generationScriptName?this.generationScriptName:this.editNode.data.sc_name;var r=[{scriptname:t}];Object(s["h"])(r).then((function(t){200===t.statusCode?"null"===t.data.resultlog?(clearInterval(e.logClock),e.getLogResult()):(e.logContent=t.data.resultlog[0].logconet,e.logname=t.data.resultlog[0].logname):e.$message({message:t.msg,type:"warning"})}))},getLogResult:function(){var e=this,t="";t=this.generationScriptName?this.generationScriptName:this.editNode.data.sc_name;var r=[{scriptname:t}];Object(s["i"])(r).then((function(t){if(200===t.statusCode){e.logname=t.data.logname;var r=t.data.resultlog.slice(-8);console.log(r),e.logContent=r.join("; ")}else e.$message({message:t.msg,type:"warning"})}))},getTree:function(){var e=this;console.log("getTree==="),console.log("updataTreeData22");var t=window.localStorage.getItem("uid");Object(s["m"])(Number(t)).then((function(t){if(200===t.statusCode){var r=t.date;r&&r.length>0?(e.creatBtn=!1,e.treeDataList=Object(o["a"])(t.date),console.log("updataTreeData父组件更新了tree",r)):e.creatBtn=!0}else e.$message({message:t.msg,type:"warning"})}))},handleRun:function(){"运行"===this.scriptBtn?this.scriptBtn="终止":this.scriptBtn="运行"},handleCreatNode:function(e,t){this.curNode=e,this.form.filename="",this.creatVisible=!0,this.file_type=1,this.pid=e.data.id,this.creatTitle="创建项目"},handleCreatProject:function(){var e=this,t=window.localStorage.getItem("uid");console.log(t);for(var r=this.curNode,i=1;i<this.curNode.level;i++)r=r.parent;1===this.file_type?Object(s["d"])(this.form.filename,this.pid,this.file_type,t,{type:2,tree_id:r.data.id,uid:this.$store.state.user.uid}).then((function(t){200===t.statusCode?(e.$message({message:t.msg,type:"success"}),e.creatVisible=!1,e.getTree()):e.$message({message:t.msg,type:"warning"})})):2===this.file_type&&Object(s["d"])(this.form.scriptName,this.pid,this.file_type,t,{type:2,tree_id:r.data.id,uid:this.$store.state.user.uid}).then((function(t){200===t.statusCode?(e.$message({message:t.msg,type:"success"}),e.creatScriptVisible=!1,e.getTree()):e.$message({message:t.msg,type:"warning"})}))},handleCreatScript:function(e,t){this.curNode=e,this.form.scriptName="",this.creatScriptVisible=!0,this.creatTitle="创建脚本",this.file_type=2,this.pid=e.data.id},handleCreatFullLinkScript:function(e,t){this.FullLinkVisible=!0,this.curNode=e,this.file_type=2,this.pid=e.data.id},handleEditFullLinkScipt:function(){var e=this,t=window.localStorage.getItem("uid");console.log(t);for(var r=this.curNode,i=1;i<this.curNode.level;i++)r=r.parent;Object(s["d"])(this.linkForm.name,this.pid,3,t,{type:2,tree_id:r.data.id,uid:this.$store.state.user.uid}).then((function(t){200===t.statusCode?(e.$message({message:t.msg,type:"success"}),e.FullLinkVisible=!1,e.getTree(),console.log("更新的了树更新的了树更新的了树更新的了树更新的了树更新的了树")):e.$message({message:t.msg,type:"warning"})}))},append:function(e,t){this.expandArr.push(e.data.id),this.currentNodeName=e.data.label,e.data.level<3?(this.popScript=!1,this.popProject=!0):(this.popProject=!1,this.popScript=!0)},remove:function(e,t){var r=this;this.curNode=e;for(var i=this.curNode,a=1;a<this.curNode.level;a++)i=i.parent;this.expandArr.push(e.data.id),this.$confirm("此操作将删除相关内容，是否继续？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then((function(){1===e.data.file_type?0===e.data.children.length?Object(s["f"])(e.data.id,{type:2,tree_id:i.data.id,uid:r.$store.state.user.uid}).then((function(e){r.getTree(),r.$message({message:e.msg,type:"success"})})):r.$message({message:"该项目不为空，不能删除",type:"warning"}):(2===e.data.file_type||3===e.data.file_type)&&Object(s["f"])(e.data.id,{type:2,tree_id:i.data.id,uid:r.$store.state.user.uid}).then((function(e){200===e.statusCode?(r.getTree(),r.$message({message:e.msg,type:"success"})):r.$message({message:e.msg,type:"warning"})}))})).catch((function(){r.$message({type:"info",message:"已取消删除"})}))},edit:function(e,t){this.curNode=e,this.expandArr.push(e.data.id),this.currentNodeName=e.data.label,1===e.data.file_type&&1!==e.data.level?(this.editVisible=!0,this.editNode=e,this.form.eidtfilename=e.data.label):1===e.data.file_type&&1===e.data.level?this.editNode=e:2!==e.data.file_type&&3!==e.data.file_type||(console.log(e),""===e.data.sc_name&&""===this.generationScriptName?this.isScriptName=!0:this.isScriptName=!1,this.editName=!0,this.editScriptContent=!0,this.editNode=e)},handleEditScriptName:function(){var e=this;console.log(this.editNode);for(var t=this.curNode,r=1;r<this.curNode.level;r++)t=t.parent;var i={type:2,tree_id:t.data.id,uid:this.$store.state.user.uid};console.log(i),Object(s["r"])({id:this.editNode.data.id,filename:this.form.editScriptName,file_type:1,Permission_parameters:i}).then((function(t){console.log(t),e.editScriptNameVisible=!1,200===t.statusCode?(e.getTree(),e.$message({message:t.msg,type:"success"})):e.$message({message:t.msg,type:"warning"})}))},handleEditProject:function(){var e=this;if(1===this.editNode.data.file_type){for(var t=this.curNode,r=1;r<this.curNode.level;r++)t=t.parent;Object(s["r"])({id:this.editNode.data.id,filename:this.form.eidtfilename,file_type:1,Permission_parameters:{type:2,tree_id:t.data.id,uid:this.$store.state.user.uid}}).then((function(t){200===t.statusCode?(e.editVisible=!1,e.getTree(),e.$message({message:t.msg,type:"success"})):e.$message({message:t.msg,type:"warning"})}))}else 2===this.editNode.data.file_type&&(this.currentType="editScript")},cancleAddProject:function(){this.form.rootProjectName="",this.newProjectVisible=!1},addProjectComfirm:function(){var e=this;u({filename:this.form.rootProjectName,pid:0,file_type:1,Permission_parameters:{type:2,tree_id:0,uid:this.$store.state.user.uid}}).then((function(t){console.log(t),200===t.statusCode?(e.newProjectVisible=!1,e.getTree(),e.$message({message:t.msg,type:"success"})):e.$message({message:t.msg,type:"warning"})}))}}},he=fe,ge=(r("a14f"),Object(T["a"])(he,i,a,!1,null,"24f95c12",null));t["default"]=ge.exports},"6d95":function(e,t,r){},7077:function(e,t,r){},"777c":function(e,t,r){"use strict";var i=r("9be6"),a=r.n(i);a.a},"83de":function(e,t,r){"use strict";var i=r("f1ad"),a=r.n(i);a.a},"9be6":function(e,t,r){},a14f:function(e,t,r){"use strict";var i=r("7077"),a=r.n(i);a.a},a351:function(e,t,r){},ad4b:function(e,t,r){"use strict";var i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"timerdialog"}},[r("el-dialog",{attrs:{title:"设置定时任务",visible:e.dialogTableVisible},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[r("el-table",{attrs:{data:e.gridData}},[r("el-table-column",{attrs:{property:"date",label:"一级树名称",width:"150"}}),e._v(" "),r("el-table-column",{attrs:{property:"name",label:"脚本名称",width:"200"}}),e._v(" "),r("el-table-column",{attrs:{property:"address",label:"创建人"}})],1),e._v(" "),r("div",{staticClass:"block"},[r("span",{staticClass:"demonstration"},[e._v("选择定时运行时间")]),e._v(" "),r("el-date-picker",{attrs:{type:"datetime",placeholder:"请选择定时运行时间","default-time":"12:00:00"},model:{value:e.value,callback:function(t){e.value=t},expression:"value"}})],1),e._v(" "),r("div",{staticStyle:{margin:"15px 0"}},[e._v("选择运行周期")]),e._v(" "),r("el-checkbox",{attrs:{indeterminate:e.isIndeterminate},on:{change:e.handleCheckAllChange},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}},[e._v("全选")]),e._v(" "),r("el-checkbox-group",{on:{change:e.handleCheckedCitiesChange},model:{value:e.checkedCities,callback:function(t){e.checkedCities=t},expression:"checkedCities"}},e._l(e.cities,(function(t){return r("el-checkbox",{key:t,attrs:{label:t}},[e._v(e._s(t))])})),1),e._v(" "),r("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.dialogTableVisible=!1}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:e.dialogok}},[e._v("确 定")])],1)],1)],1)},a=[];r("337a");var o=["星期一","星期二","星期三","星期四","星期五","星期六","星期日"],n={data:function(){return{gridData:[{date:"2016-05-02",name:"王小虎",address:"上海市普陀区金沙江路 1518 弄"},{date:"2016-05-04",name:"王小虎",address:"上海市普陀区金沙江路 1518 弄"},{date:"2016-05-01",name:"王小虎",address:"上海市普陀区金沙江路 1518 弄"},{date:"2016-05-03",name:"王小虎",address:"上海市普陀区金沙江路 1518 弄"}],dialogTableVisible:!1,value:"",checkAll:!1,checkedCities:["星期一","星期二"],cities:o,isIndeterminate:!0}},methods:{handleCheckAllChange:function(e){this.checkedCities=e?o:[],this.isIndeterminate=!1},handleCheckedCitiesChange:function(e){var t=e.length;this.checkAll=t===this.cities.length,this.isIndeterminate=t>0&&t<this.cities.length},dialogok:function(){this.dialogTableVisible=!1}}},s=n,l=(r("3d81"),r("2877")),c=Object(l["a"])(s,i,a,!1,null,"5cb4d02e",null);t["a"]=c.exports},f1ad:function(e,t,r){}}]);